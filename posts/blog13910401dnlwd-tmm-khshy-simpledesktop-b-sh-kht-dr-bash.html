<!DOCTYPE html><html lang="fa"><head><meta charset="utf-8"><meta name="description" content=""><meta name="author" content="شاهین آزاد"><title>دانلود تمام عکس‌های SimpleDesktop با سه خط در Bash! | شاهینیسم</title><link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/rst.css" rel="stylesheet" type="text/css"><link href="../assets/css/code.css" rel="stylesheet" type="text/css"><link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css"><link href="../assets/css/theme.css" rel="stylesheet" type="text/css"><link href="../assets/css/custom.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
<![endif]--><link rel="alternate" type="application/rss+xml" title="RSS fa" href="../rss.xml"></head><body class="home blog">
    
    <script type="text/javascript">var addthis_config={"ui_language":"${lang}"};</script><div id="siteWrapper">
      <h1 id="vcard author">
        <a href="../" title="شاهینیسم">شاهینیسم</a>
      </h1>

      <div id="mainNav">
        <ul><li><a href="../stories/drbrh-mn-2.html">About</a>



  </li><li><a href="../archive.html">Archives</a>



  </li><li><a href="../categories/index.html">Tags</a>



  </li><li><a href="http://feeds.feedburner.com/Shahinism">RSS</a>


</li>
        </ul></div>
      <div id="siteDescription">
        
        
        
      </div>
      <div id="coreContent" class="hfeed">
        
<div id="coreContent">
  <div class="post single hentry">
    <div class="postContent">
      <h3 class="entry-title">
<h1>دانلود تمام عکس‌های SimpleDesktop با سه خط در Bash!</h1>

</h3>
      <div class="entry-content">
        <p></p><a title="سینا احسانی در پلاس" href="https://plus.google.com/u/0/102916660970180940856" target="_blank">سینا احسانی</a> عزیز در پلاس گفت که با VB برنامه‌ای نوشته که تمام عکس‌های سایت <a title="SimpleDesktops official website!" href="http://simpledesktops.com/" target="_blank">SimpleDesktop</a> را دانلود می‌کند‌. وقتی سایت را دیدم واقعا از تصاویرش خوشم آمد‌. خیلی وقت بود که پس‌زمینهٔ دسکتاپم یک تصویر ساده بود که ثابت مانده بود‌. این شد که تصمیم گرفتم من هم عکس‌ها را دانلود کنم‌. البته کاملا لینوکسی‌!
بررسی اولیه سایت معلوم کرد که پس از انتخاب عکس و کلیک آخر برای دانلود عکس شما با لینکی به صورت زیر طرف هستید‌:
<div class="code"><pre>http://simpledesktops.com/download/?desktop<span class="o">=</span>301
</pre></div>


<p>همهٔ آدرس جز عدد ۳۰۱ در انتهایش ثابتند و آن عدد از ۱ یکی‌‌یکی زیاد می‌شود‌. هر کدام از این عکس‌ها پس از درخواست شدنشان به آدرس یکی از عکس‌های روی سرور اشاره می‌کنند‌. خوب دیگر داستان از این هم ساده‌تر می‌شود؟ کافیست که اراده کنیم و با یک حلقهٔ for اعداد را تولید کنیم و جلوی آدرس ثابتمان بنویسیم‌. پس می‌شود این:</p>
<div class="code"><pre><span class="c">#!/usr/bin/bash</span>



<span class="k">for </span>i in <span class="o">{</span>1..5000<span class="o">}</span>

<span class="k">do</span>

<span class="nb">echo</span> <span class="s2">"http://simpledesktops.com/download/?desktop=$i"</span>

<span class="k">done</span>
</pre></div>


<p>به بش گفتیم که هر بار یک عدد از یک تا پنج‌هزار (البته به ترتیب از کم به زیاد) تولید کن و در خروجی چاپ کن‌. یک بار اسکریپت را ران می‌کنیم و ... بعله خروجی دقیقا همان آدرس‌هایی که خواستیم می‌شود‌:</p>
<div class="code"><pre>...

http://simpledesktops.com/download/?desktop<span class="o">=</span>4995

http://simpledesktops.com/download/?desktop<span class="o">=</span>4996

http://simpledesktops.com/download/?desktop<span class="o">=</span>4997

http://simpledesktops.com/download/?desktop<span class="o">=</span>4998

http://simpledesktops.com/download/?desktop<span class="o">=</span>4999

http://simpledesktops.com/download/?desktop<span class="o">=</span>5000
</pre></div>


<p>حالا کافیست در اسکریپت به جای echo که هر چه جلویش باشد را در خروجی استاندارد چاپ می‌کند یک wget بنویسیم تا آدرس‌های جلویش را دانلود کند‌. اما نه‌! در اولین اقدام تیرمان خطا رفت‌! در سرور‌های Apache یک فایلی هست به اسم ‎.htaccess و همان‌طور که از نامش معلوم است کارش این است که کنترل کند چه کسی به کجا دسترسی دارد‌. هر نرم‌افزاری هم که به یکی از این سرور‌ها درخواست بدهد موظف است اول خودش را معرفی کند‌. خوب wget که از نامش فساد می‌بارد عموما از طرف چنین سایت‌هایی مسدود می‌شود‌.</p>
<p>این است که باید به wget بگوییم نقابش را به صورت بزند و دوباره اقدام کند‌. اینبار اسکریپتمان این شکلی می‌شود‌:</p>
<div class="code"><pre><span class="c">#!/usr/bin/bash</span>



<span class="k">for </span>i in <span class="o">{</span>100..5000<span class="o">}</span>

<span class="k">do</span>

wget -U <span class="s2">"Mozilla/5.0 (Windows NT 5.1; rv:10.0.2) Gecko/20100101 Firefox/10.0.2"</span> <span class="s2">"http://simpledesktops.com/download/?desktop=$i"</span>

<span class="k">done</span>
</pre></div>


<p>و بعله‌! ران می‌کنیم و خیلی خوشکل اقدام به دانلود عکس‌ها می‌کنیم ;-)</p>
<p><strong>پی‌نوشت:</strong> در حین جستجو برای نوشتن این اسکریپت کشف کردم که قبلا اسکریپت‌هایی با Python یا PHP هم برای شیره‌کشی از این سایت نوشته شده‌. ولی این اسکریپت از همه‌شان کوتاه‌تر بود و خوب سادگی زیبـــــاست ;-)</p>
<p><strong>پی‌نوشت ۲</strong>: دیگر خودتان حواستان باشد که ‎#!‎/‎usr/bin/bash آدرس bash سیستم من است و می‌توانید با یک whereis bash پیدا کنید که مال شما کجاست‌!</p>
<p><span style="color: #ff0000;"><strong>پی‌نوشت ۳:</strong> ممکنه بعد از دانلود متوجه بشین که فایل‌های دانلودی با یه همچین اسمایی ذخیره می‌شن index.html?desktop=100 اتفاقی که برای من روی سرور آرچ افتاد‌. عجیب بود که اسم فایل درست رو می‌دید ولی خودش از رو این Querystring ساخته شده اسم رو می‌نوشت‌. پس از جستجو کشف کردم که باید آپشن زیر هم به wget اضافه بشه:</span></p>
<p>```bash</p>
<p>--content-disposition</p>
<p>```</p>
      </div>
      <div class="postMeta">
        <div class="postDate"><span>ارسال شده:</span> <abbr class="published">2012-06-21 20:15</abbr></div>
        


        <div class="categories">

<span>ارسال‌های بیشتر دربارهٔ</span>

<a class="tag" href="../categories/bash.html"><span class="badge-info">bash</span></a>

<a class="tag" href="../categories/echo.html"><span class="badge-info">echo</span></a>

<a class="tag" href="../categories/wget.html"><span class="badge-info">wget</span></a>

<a class="tag" href="../categories/yntrnt.html"><span class="badge-info">اینترنت</span></a>

<a class="tag" href="../categories/brnmh-nwysy.html"><span class="badge-info">برنامه نویسی</span></a>

<a class="tag" href="../categories/nrm-fzr.html"><span class="badge-info">نرم افزار</span></a>

<a class="tag" href="../categories/gnwlynwkhs.html"><span class="badge-info">گنو/لینوکس</span></a>


</div>
      </div>
    </div>

    <div class="pageNav">
      
<ul class="pager"><div class="prev">
    <a href="blog13910331trmyntwr-akhrlzmn-trmynlh.html">← ارسال پیشین</a>
  </div>
  
  
  <div class="next">
    <a href="blog13910406wqy-ngry-shkhsy-szy-emacs-qsmt-wl.html">ارسال بعدی →</a>
  </div>
  
  </ul></div>
    <div class="postMeta">
      
      
    
        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname ="shahinism";
        
            var disqus_url="http://shahinism.com/posts/blog13910401dnlwd-tmm-khshy-simpledesktop-b-sh-kht-dr-bash.html";
        
        var disqus_title="\u062f\u0627\u0646\u0644\u0648\u062f \u062a\u0645\u0627\u0645 \u0639\u06a9\u0633\u200c\u0647\u0627\u06cc SimpleDesktop \u0628\u0627 \u0633\u0647 \u062e\u0637 \u062f\u0631 Bash!";
        var disqus_identifier="cache/posts/blog13910401dnlwd-tmm-khshy-simpledesktop-b-sh-kht-dr-bash.html";
        var disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

      
    </div>

  </div>
</div>
  
      </div>
    </div>
    <div id="footer">
      <h5>Elsewhere</h5>
      <ul class="elsewhere"><a href="https://plus.google.com/117086743723717964659/posts">Google Plus</a> |
<a href="http://www.goodreads.com/user/show/4795670-shahin-azad">Good Reads</a> |
<a href="https://identi.ca/shahinism">Identica</a> |
<a href="http://twitter.com/shahinism">Twitter</a> |
<a href="https://github.com/shahinism">Github</a>
      </ul><div class="footerContent">
        
<!-- Custom search -->
<form method="get" id="searchform" action="http://duckduckgo.com/">
<div id="search">
<input type="hidden" name="sites" value="http://shahinism.com"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="جستجو…"><input type="submit" id="searchsubmit" value="DDG Search"></div>
</form>
<!-- End of custom search -->

        <p> Contents © 2013 <a href="mailto:ishahinism@gmail.com">شاهین آزاد</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a> </p>
        <p> Design by <a href="http://themes.jimbarraud.com/manifest/">Jimbarraud</a> + some <a href="http://shahinism.com">Shahinism</a> twists. </p>
      </div>
    </div>
    
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-23874419-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></body></html>