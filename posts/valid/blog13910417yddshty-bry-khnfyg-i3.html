<!DOCTYPE html><html lang="fa">
  <head>
    
<meta charset="utf-8">
<meta name="description" content="">
<meta name="author" content="شاهین آزاد">
<title>یادداشتی برای کانفیگ i3 | شاهینیسم</title>

<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">

<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
<![endif]-->


<link rel="alternate" type="application/rss+xml" title="RSS fa" href="../../rss.xml">




    

  



    
  </head>
  <body class="home blog">
    
    <script type="text/javascript">var addthis_config={"ui_language":"${lang}"};</script>
    

    <div id="siteWrapper">
      <h1 id="vcard author">
        <a href="../../" title="شاهینیسم">شاهینیسم</a>
        <a href="http://internetdefenseleague.org"><img src="http://internetdefenseleague.org/images/badges/final/footer_badge.png" alt="Member of The Internet Defense League" style="float: left; position: absolute; margin: 0px 90px;"></a>
      </h1>

      <div id="mainNav">
        <ul>
          


  <li><a href="../../archive.html">Archives</a>



  </li><li><a href="../../categories/index.html">Tags</a>



  </li><li><a href="../../rss.xml">RSS</a>


</li>
        </ul>
      </div>
      <div id="siteDescription">
        
        
        
      </div>
      <div id="coreContent" class="hfeed">
        
<div id="coreContent">
  <div class="post single hentry">
    <div class="postContent">
      <h3 class="entry-title">
<h1>یادداشتی برای کانفیگ i3</h1>

</h3>
      <div class="entry-content">
        <p>patch -p1 &lt; i3-wm-pango.patch</p>
<div class="code"><pre><span class="err">دوستان</span> <span class="err">اسلکوری</span> <span class="err">هم</span> <span class="err">می‌توانند</span> <span class="err">باقی</span> <span class="err">کار</span> <span class="err">را</span> <span class="err">به</span> <span class="err">این</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="n">title</span><span class="o">=</span><span class="s2">"i3 &amp;amp; i3status slackbuilds"</span> <span class="n">href</span><span class="o">=</span><span class="s2">"http://slackbuilds.org/result/?search=i3&amp;amp;sv=13.37"</span> <span class="n">target</span><span class="o">=</span><span class="s2">"_blank"</span><span class="o">&gt;</span><span class="nx">Slackbuild</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span> <span class="err">بسپارند‌</span><span class="nx">.</span> <span class="err">پس</span> <span class="err">از</span> <span class="err">نصب</span> <span class="err">میزکار</span> <span class="err">را</span> <span class="err">اجرا</span> <span class="err">کنید‌</span><span class="nx">.</span> <span class="err">چیزی</span> <span class="err">که</span> <span class="err">ما</span> <span class="err">می‌خواهیم</span> <span class="err">در</span> <span class="err">نهایت</span> <span class="err">شبیهش</span> <span class="err">شویم</span> <span class="err">به</span> <span class="err">صورت</span> <span class="err">زیر</span> <span class="err">است</span><span class="p">:</span>

<span class="o">&lt;</span><span class="nx">p</span> <span class="n">style</span><span class="o">=</span><span class="s2">"text-align: center;"</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">"http://dl.dropbox.com/u/25017694/Blog-photos/snapshot.png"</span><span class="o">&gt;&lt;</span><span class="nb">img</span> <span class="n">class</span><span class="o">=</span><span class="s2">"aligncenter"</span> <span class="n">src</span><span class="o">=</span><span class="s2">"http://dl.dropbox.com/u/25017694/Blog-photos/snapshot.png"</span> <span class="n">alt</span><span class="o">=</span><span class="s2">""</span> <span class="n">width</span><span class="o">=</span><span class="s2">"430"</span> <span class="n">height</span><span class="o">=</span><span class="s2">"323"</span><span class="o">&gt;&lt;/</span><span class="nx">a</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>

<span class="err">قبل</span> <span class="err">از</span> <span class="err">این</span> <span class="err">که</span> <span class="err">بگویید</span> <span class="err">این</span> <span class="err">که</span> <span class="err">چیزی</span> <span class="err">ندارد</span> <span class="err">تا</span> <span class="err">بخواهیم</span> <span class="err">کانفیگش</span> <span class="err">کنیم</span> <span class="err">بگذارید</span> <span class="err">بگویم</span> <span class="err">که</span> <span class="err">دو</span> <span class="err">روز</span> <span class="err">وقتم</span> <span class="err">را</span> <span class="err">گرفت</span> <span class="err">تا</span> <span class="err">بتوانم</span> <span class="err">به</span> <span class="err">اینجا</span> <span class="err">برسانمش</span> <span class="p">;</span><span class="o">-</span><span class="p">)</span>

<span class="err">برای</span> <span class="err">شروع</span> <span class="err">کار</span> <span class="err">می‌خواهیم</span> <span class="err">فونت</span> <span class="err">میزکار</span> <span class="err">را</span> <span class="err">تعیین</span> <span class="err">کنیم‌</span><span class="nx">.</span> <span class="err">فایل</span> <span class="err">کانفیگ</span> <span class="nx">i3</span> <span class="err">برای</span> <span class="err">هر</span> <span class="err">کاربر</span> <span class="err">از</span> <span class="err">شاخهٔ</span> <span class="err">‎~</span><span class="p">/</span><span class="nx">.i3</span><span class="p">/</span><span class="nx">config</span> <span class="err">خوانده</span> <span class="err">می‌شود‌</span> <span class="p">(</span><span class="err">توجه</span> <span class="err">داشته</span> <span class="err">باشید</span> <span class="err">که</span> <span class="err">در</span> <span class="err">اولین</span> <span class="err">اجرا</span> <span class="err">اگر</span> <span class="err">این</span> <span class="err">فایل</span> <span class="err">وجود</span> <span class="err">نداشته</span> <span class="err">باشد</span> <span class="err">برنامهٔ</span> <span class="err">کانفیگ</span> <span class="err">خودکار</span> <span class="nx">i3</span> <span class="err">شروع</span> <span class="err">می‌شود</span> <span class="err">و</span> <span class="err">از</span> <span class="err">شما</span> <span class="err">می‌پرسد</span> <span class="err">که</span> <span class="err">کدام</span> <span class="err">کلید</span> <span class="err">را</span> <span class="err">به</span> <span class="err">عنوان</span> <span class="nb">meta</span><span class="err">یتان</span> <span class="err">تعریف</span> <span class="err">کند‌</span> <span class="err">و</span> <span class="err">بعد</span> <span class="err">این</span> <span class="err">فایل</span> <span class="err">ساخته</span> <span class="err">می‌شود</span><span class="o">-</span><span class="err">اگر</span> <span class="err">هم</span> <span class="err">نشد</span> <span class="err">در</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="n">title</span><span class="o">=</span><span class="s2">"i3 userguide"</span> <span class="n">href</span><span class="o">=</span><span class="s2">"http://i3wm.org/docs/userguide.html"</span> <span class="n">target</span><span class="o">=</span><span class="s2">"_blank"</span><span class="o">&gt;</span><span class="nx">userguide</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span> <span class="err">دنبالش</span> <span class="err">بگردید</span> <span class="err">و</span> <span class="err">مسیرش</span> <span class="err">را</span> <span class="err">ببینید</span><span class="o">!</span><span class="p">)</span> <span class="err">فایل</span> <span class="err">کانفیگ</span> <span class="err">را</span> <span class="err">پیدا</span> <span class="err">می‌کنیم</span> <span class="err">و</span> <span class="err">دنبال</span> <span class="err">خط</span> <span class="err">زیر</span> <span class="err">می‌گردیم</span><span class="p">:</span>

<span class="sb">``</span><span class="err">`</span><span class="nx">bash</span>

<span class="nx">font</span> <span class="na">-misc-fixed-medium-r-normal</span><span class="o">--</span><span class="mi">13</span><span class="o">-</span><span class="mi">120</span><span class="o">-</span><span class="mi">75</span><span class="o">-</span><span class="mi">75</span><span class="na">-C</span><span class="o">-</span><span class="mi">70</span><span class="na">-iso10646</span><span class="o">-</span><span class="mi">1</span>
</pre></div>


<p>و آن را به صورت زیر ویرایش می‌کنیم:</p>
<div class="code"><pre>font xft:Terminus 9
</pre></div>


<p>همچنین از آن‌جا که ترمینال پیش‌فرض i3 را دوست نداریم و می‌خواهیم Terminator جایگزینش شود به دنبال ‎# start a terminal می‌گردیم و خط زیرش را به صورت زیر ویرایش می‌کنیم:</p>
<div class="code"><pre>bindsym <span class="nv">$mod</span>+Return <span class="nb">exec</span> --no-startup-id terminator
</pre></div>


<p>در ادامهٔ کار با کانفیگ‌های پیش‌فرض i3 می‌سازیم‌، جز این که یک مشکل کوچک و قابل حل وجود دارد‌. آن هم این که بعد از تغییر layout کیبورد به فارسی دیگر کلید‌های میانبر میزکارمان کار نمی‌کنند و باید layout را انگلیسی کنیم تا به کار بیافتند‌. برای حل این مشکل باید به جای کلید‌های bindsym (کلید‌های میانبری که با اسم کلید مثلا shift, Return و ... تعریف می‌شوند) از bindcode استفاده کنیم‌. برای نمونه ما کلید‌های میانبر تغییر layout را به این صورت تعریف می‌کنیم.</p>
<p>کلید‌های مدنظر ما برای تغییر صفحه کلید Alt+Shift است‌. اول از همه در اول فایل کانفیگ یک متغیر به اسم ‎$mod1 که به Alt اشاره می‌کند به صورت زیر تعریف می‌کنیم:</p>
<div class="code"><pre><span class="nb">set</span> <span class="nv">$mod1</span> Mod1
</pre></div>


<p>و سپس خطوط زیر را در انتهای فایل کانفیگ اضافه می‌کنیم:</p>
<div class="code"><pre>bindcode <span class="nv">$mod1</span>+62 <span class="nb">exec</span> ~/.i3/changekb.sh

bindcode <span class="nv">$mod1</span>+50 <span class="nb">exec</span> ~/.i3/changekb.sh
</pre></div>


<p>خوب حالا این دو خط چه می‌کنند؟ دستور bindcode به i3 می‌فهماند که باید از کد کلید‌های کیبورد برای شناسایی کلید ترکیبی استفاده کند‌. ‎$mod1 را هم که پیشتر خودمان به عنوان کلید Alt تعریف کردیم‌. حالا می‌ماند اعداد ۶۲ و ۵۰‌. این اعداد کد‌هایی هستند که کلید‌های شیفت چپ و راست کیبورد با آن‌ها شناخته می‌شوند و دقیقا مختص همین کلید‌ها هستند‌. برای کشفشان می‌توانید در ترمینال برنامهٔ xev را اجرا کنید کلید مورد نظرتان را فشار دهید و در خروجی‌ها به دنبال عبارت keycode و عدد روبرویش بگردید‌.</p>
<p>exec هم فرمانی است که با استفاده از آن می‌توانیم یک اسکریپت خارجی را اجرا کنیم که در اینجا ما اسکریپتی که layout را بررسی می‌کند و با توجه به وضعیت فعلی‌اش آن را به انگلیسی یا فارسی تغییر می‌دهد را به آن شناساندیم‌. پس لازم است کد زیر را که مربوط به این اسکریپت است در فایل changekb.sh وارد کرده و فایل را به پوشهٔ ‎.i3 در پوشهٔ خانگیتان کپی کنید:</p>
<div class="code"><pre><span class="c">#This is a script for changing keyboard between English and Persian layouts</span>

<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>setxkbmap -print | grep xkb_symbols | awk <span class="s1">'{print $4}'</span> | awk -F<span class="s2">"+"</span> <span class="s1">'{print $2}'</span><span class="sb">`</span> <span class="o">=</span> us <span class="o">]</span>;

<span class="k">then </span><span class="nb">echo</span> <span class="s2">"EN"</span>; <span class="nb">echo</span> <span class="s2">"changing to IR..."</span>; setxkbmap ir;

<span class="k">else </span><span class="nb">echo</span> <span class="s2">"IR"</span>; <span class="nb">echo</span> <span class="s2">"Changing to US..."</span>; setxkbmap us ;

<span class="k">fi</span>
</pre></div>


<p>نکته اینجاست که نمی‌دانم چرا Alt+Shift راست پس از تغییر layout به فارسی قادر به بازگردانیش به انگلیسی نیستند‌، در حالی که کلید‌های سمت چپ به راحتی این کار را انجام می‌دهند‌! البته این کار مزیتی برای خودش دارد و آن هم این که با استفاده از کلید‌های سمت راست دیگر خیالم راحت است که کیبورد فارسی است ;-)</p>
<p>در ادامه به حیاتی‌ترین بخش میزکارمان می‌رسیم‌. بخش گزارش‌گیری‌! نوار پایینی میزکار توسط برنامهٔ i3bar کنترل می‌شود‌. این برنامه می‌تواند خروجی برنامه‌های مختلف را در خود نمایش دهد‌. خود i3 برنامه‌ای به اسم i3status برای گزارش‌گیری دارد که من زیاد از آن خوشم نیامد‌. این شد که تصمیم گرفتم از conky برای این بخش استفاده کنم‌. چون هم ابزار‌های بیشتری دارد و هم قابلیت اجرای یک اسکریپت خارجی را بدون درد و خونریزی! این شد که به دنبال خط bar که احتمالا در انتهای فایل کانفیگ قرار دارد می‌گردیم و در میان آکولاد‌های روبرویش دو خط زیر را اضافه می‌کنیم:</p>
<div class="code"><pre>font -*-terminus-bold-*-*-*-12-*-*-*-*-*-iso10646-*

status_command <span class="nb">exec </span>conky -c ~/.i3/i3conky
</pre></div>


<p>خط اول این دستور که فونت terminus را برای خروجی i3bar تعریف کرده را می‌توانید نادیده بگیرید و یا به صورت xft مثل دفعهٔ قبل تعیین کنید‌. اما خط دوم دستور conky را با فایل کانفیگ i3conky که در شاخهٔ ‎.i3 قرار دارد اجرا می‌کند‌. پس لازم است این فایل را ایجاد کنید و دستورات زیر را در آن کپی کنید:</p>
<div class="code"><pre>background no

out_to_console yes

double_buffer no

short_units yes

out_to_x no

update_interval 1.0

total_run_times 0

use_spacer right



TEXT

CPU: <span class="k">${</span><span class="nv">cpu</span><span class="p"> cpu1</span><span class="k">}</span>,<span class="k">${</span><span class="nv">cpu</span><span class="p"> cpu2</span><span class="k">}</span>,<span class="k">${</span><span class="nv">cpu</span><span class="p"> cpu3</span><span class="k">}</span>,<span class="k">${</span><span class="nv">cpu</span><span class="p"> cpu4</span><span class="k">}</span> @ FRQ: <span class="nv">$freq</span> | RAM:<span class="nv">$mem</span>/<span class="k">${</span><span class="nv">memmax</span><span class="k">}</span> <span class="o">(</span><span class="nv">$memperc</span>%<span class="o">)</span> <span class="k">${</span><span class="nv">if_up</span><span class="p"> eth0</span><span class="k">}</span>| LAN: D:<span class="k">${</span><span class="nv">downspeed</span><span class="p"> eth0</span><span class="k">}</span> U:<span class="k">${</span><span class="nv">upspeed</span><span class="p"> eth0</span><span class="k">}</span> <span class="k">${</span><span class="nv">endif</span><span class="k">}</span> <span class="se">\</span>

| <span class="k">${</span><span class="nv">exec</span><span class="p"> ~/.i3/kbstatus.sh</span><span class="k">}</span> | VOL: <span class="nv">$mixer</span> | <span class="k">${</span><span class="nv">time</span><span class="p"> %a %d.%m.%y</span><span class="k">}</span> <span class="k">${</span><span class="nv">time</span><span class="p"> %H:%M</span><span class="k">}</span>
</pre></div>


<p>توضیح آرگومان‌های این فایل بماند به عهدهٔ خودتان‌. فقط من برای دیدن وضعیت فعلی صفحه کلید اسکریپت تغییر صفحه کلید را ویرایش کردم و آن را به اسم kbstatus.sh در شاخهٔ ‎.i3 قرار دادم تا از conky آن را فرا بخوانم‌. این اسکریپت فقط layout فعلی را در خروجی نشان می‌دهد و کدش به صورت زیر است:</p>
<div class="code"><pre><span class="c">#!/usr/bin/bas</span>

setxkbmap -print | grep xkb_symbols | awk <span class="s1">'{print $4}'</span> | awk -F<span class="s2">"+"</span> <span class="s1">'{print $2}'</span>
</pre></div>


<p>کانفیگ میزکارمان دیگر تقریبا تمام شده‌. فقط می‌ماند یک چند تا ریزه کاری‌. i3 به صورت پیش‌فرض صفحه را از طرفی که بزرگتر است نصف می‌کند‌. پس دز عمدهٔ مانیتور‌ها این مسیر به صورت افقی تعریف می‌شود‌. حال آن که من تقسیم عمودی را بیشتر ترجیح می‌دهم‌. پس با خط زیر به i3 می‌فهمانم که این کار را طبق نظر من انجام دهد:</p>
<div class="code"><pre>default_orientation vertical
</pre></div>


<p>همچنین می‌خواهم تعدادی از برنامه‌هایم مثل mdic یا vlc به صورت float (تایل نشده) باز شوند که برای این کار دستورات زیر را اضافه می‌کنم:</p>
<div class="code"><pre>for_window <span class="o">[</span><span class="nv">class</span><span class="o">=</span><span class="s2">"Vlc"</span><span class="o">]</span> floating <span class="nb">enable</span>

for_window <span class="o">[</span><span class="nv">class</span><span class="o">=</span><span class="s2">"Mdic"</span><span class="o">]</span> floating <span class="nb">enable</span>

for_window <span class="o">[</span><span class="nv">instance</span><span class="o">=</span><span class="s2">"DTA"</span><span class="o">]</span> floating <span class="nb">enable</span>

for_window <span class="o">[</span><span class="nv">instance</span><span class="o">=</span><span class="s2">"Download"</span><span class="o">]</span> floating <span class="nb">enable</span>

for_window <span class="o">[</span><span class="nv">instance</span><span class="o">=</span><span class="s2">"xfce4-notifyd"</span><span class="o">]</span> floating <span class="nb">enable</span>
</pre></div>


<p>مقدار class و یا instance را می‌توانید پس از ران کردن دستور xprop WM_CLASS و سپس کلیک روی برنامهٔ مورد نظر به دست آورید‌. مثلا در مورد فایرفاکس خروجی به صورت زیر است:</p>
<div class="code"><pre>WM_CLASS<span class="o">(</span>STRING<span class="o">)</span> <span class="o">=</span> <span class="s2">"Navigator"</span>, <span class="s2">"Firefox"</span>
</pre></div>


<p>که Nvigator مقدار instance و Firefox مقدار class است‌. توجه داشته باشید که این مقدار Case sensetive است‌!</p>
<p>من فایل کانفیگ i3 و اسکریپت‌های مورد استفاده‌ام را روی <a title="my i3 wm theme on git" href="https://github.com/shahinism/i3-wm-theme" target="_blank">این کانال git</a> گذاشته‌ام‌. برای پی‌بردن بیشتر به جزئیات می‌توانید از آن‌ها استفاده کنید!</p>
      </div>
      <div class="postMeta">
        <div class="postDate"><span>ارسال شده:</span> <abbr class="published">2012-07-07 06:32</abbr></div>
        


        <div class="categories">

</div>
      </div>
    </div>

    <div class="pageNav">
      
<ul class="pager">
  
  <div class="prev">
    <a href="blog13910415tjrbh-khr-b-i3-ykh-rgyb-qdr.html">← ارسال پیشین</a>
  </div>
  
  
  <div class="next">
    <a href="blog13910423chgwnh-ymkhsmn-r-trbyt-khnym-qsmt-w.html">ارسال بعدی →</a>
  </div>
  
  </ul>

    </div>
    <div class="postMeta">
      
      
    
        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname ="nikolademo";
        
            var disqus_url="http://shahinism.github.io/posts/valid/blog13910417yddshty-bry-khnfyg-i3.html";
        
        var disqus_title="\u06cc\u0627\u062f\u062f\u0627\u0634\u062a\u06cc \u0628\u0631\u0627\u06cc \u06a9\u0627\u0646\u0641\u06cc\u06af i3";
        var disqus_identifier="cache/posts/valid/blog13910417yddshty-bry-khnfyg-i3.html";
        var disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

      
    </div>

  </div>
</div>
  
      </div>
    </div>
    <div id="footer">
      <h5>Elsewhere</h5>
      <ul class="elsewhere">
        <a href="https://plus.google.com/117086743723717964659/posts">Google Plus</a> |
<a href="http://www.goodreads.com/user/show/4795670-shahin-azad">Good Reads</a> |
<a href="https://identi.ca/shahinism">Identica</a> |
<a href="http://twitter.com/shahinism">Twitter</a> |
<a href="https://github.com/shahinism">Github</a>
      </ul>

      <div class="footerContent">
        
<!-- Custom search -->
<form method="get" id="search" action="http://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="http://shahinism.github.io/">
<input type="hidden" name="k8" value="#444444">
<input type="hidden" name="k9" value="#D51920">
<input type="hidden" name="kt" value="h">
<input type="text" placeholder="جستجو…" maxlength="255" name="q">
<input id="searchsubmit" type="submit" value="DDG Search">
</form>
<!-- End of custom search -->

        <p> Contents © 2014         <a href="mailto:ishahinism@gmail.com">شاهین آزاد</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>          </p>
        <p> Design by <a href="http://themes.jimbarraud.com/manifest/">Jimbarraud</a> + some <a href="http://shahinism.com">Shahinism</a> twists. </p>
      </div>
    </div>
    
  </body>
</html>