<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" dir="rtl" lang="fa">
<head>
<meta charset="utf-8">
<base href="http://5hah.in/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.html">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>dnscrypt روی اسلکور (‌و باقی لینوکس‌ها‌) .. date: 2012/2/19 | شاهین</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://5hah.in/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.html">
<link rel="icon" href="favicon.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="شاهین آزاد">
<link rel="prev" href="blog13901127zsh-dwst-shmstwp.html" title="Zsh دوست شماست‌! .. date: 2012/2/16 2:4:41" type="text/html">
<link rel="next" href="blog13901204byyyd-jmh-azd-khwd-r-drkh-khnymwp.html" title="بیایید جامعه آزاد خود را درک کنیم .. date: 2012/2/23 22:33:39" type="text/html">
<meta property="og:site_name" content="شاهین">
<meta property="og:title" content="dnscrypt روی اسلکور (‌و باقی لینوکس‌ها‌) .. date: 2012/2/19">
<meta property="og:url" content="http://5hah.in/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.html">
<meta property="og:description" content="حتما دیگه تا حالا خبر‌دار شدین که OpenDNS ابزاری آماده کرده (‌البته قبلا
برای مک آماده کرده بود‌) که ارتباط بین سیستم شما و DNS سرور‌های خودش رو
به همون روشی که SSL ارتباطاتتون رو کد می‌کنه کد کنه‌. ا">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-11-01T00:00:00+03:30">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">متن اصلی را نادیده بگیر</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://5hah.in/">

                <span id="blog-title">شاهین</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../">Home</a>
                </li>
<li>
<a href="../../stories/about-me.html">About</a>
                </li>
<li>
<a href="../../">Resume</a>
                </li>
<li>
<a href="../../archive.html">Archives</a>
                </li>
<li>
<a href="../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS</a>

                
            </li>
</ul>
<!-- Custom search --><form method="get" id="search" action="http://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="http://5hah.in/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" placeholder="جستجو…" maxlength="255" name="q"><input id="searchsubmit" type="submit" value="DDG Search">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.rst" id="sourcelink">منبع</a>
    </li>
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">dnscrypt روی اسلکور (‌و باقی لینوکس‌ها‌) .. date: 2012/2/19</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    شاهین آزاد
            </span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2015-11-01T00:00:00+03:30" itemprop="datePublished" title="2015-11-01 00:00">2015-11-01 00:00</time></a></p>
                <p class="commentline">            <a href="blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.html#disqus_thread" data-disqus-identifier="cache/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhsh.wp.html">Comments</a>


                    </p>
<p class="sourceline"><a href="blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.rst" id="sourcelink">منبع</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>حتما دیگه تا حالا خبر‌دار شدین که OpenDNS ابزاری آماده کرده (‌البته قبلا
برای مک آماده کرده بود‌) که ارتباط بین سیستم شما و DNS سرور‌های خودش رو
به همون روشی که SSL ارتباطاتتون رو کد می‌کنه کد کنه‌. اول یه توضیح در
مورد این که اصلا به چه درد می‌خوره می‌دم و بعد به چگونگی نصبش
می‌پردازم‌.</p>
<h4></h4>
<p>DNS و نقش فایل resolv.conf:</p>
<p>خوب عملا کامپیوتر‌های روی یه شبکه (‌سرور‌ها و سرویس گیرنده‌ها‌) با آدرس
آی پی شناخته می‌شن‌. خوب حالا برای من کاربر که قصد داره روی اینترنت به
یه سایت دسترسی داشته باشه‌، سخته که یه عدد نافهوم مثل 188.35.73.20 رو
حفظ کنم‌. تازه این فقط برای دسترسی به یه سایته‌. یا فرض کنین صاحب سایت
به هر دلیلی قصد تعویض سرورش رو داره‌، در این صورت باید تمام کسایی که با
آی پی قبلی به سایت دسترسی داشتن‌، از آی پی سرور جدید استفاده کنن‌. حالا
کار DNS Server‌ها اینه که می‌آن‌، هر آدرس معنادار (‌که طبیعتا استاندارد
خودش رو داره‌) رو به یه آدرس آی پی معادلش ربط می‌دن‌. اینطوریه که وقتی
شما می‌نوسین <a class="reference external" href="http://shahinism.com">http://shahinism.com</a> مرورگرتون آی پی و آدرس مسیری که وبلاگ
من توش قرار داره رو پیدا می‌کنه و بهتون نشون می‌ده‌. به همین سادگی ;-)</p>
<p>حالا بحث سر اینه که DNS Server‌های متفاوتی توی اینترنت هستن‌. هر کدومشون
با توجه به سلایق خاصی شخصی سازی شدن‌. اگه شما تا به حال نمی‌دونستین که
اصلا DNS Server چی هست‌، پس احتمالا دارین از مال ISP‌تون استفاده
می‌کنین‌. حالا ممکن شما از رفتار ISP‌تون نسبت به DNS‌ها راضی نباشین‌. یا
فکر کنین که امنیت لازم براتون از این DNS فراهم نمی‌شه (‌حتما فهمیدین که
اگه یه DNS سرور بخواد‌، می‌تونه وقتی شما <a class="reference external" href="http://google.com">http://google.com</a> رو توی
مرورگرتون می‌زنین‌، شما رو به آدرسی غیر از سرور‌های گوگل وارد کنه و این
یعنی خطر‌!)</p>
<p>این‌جاست که فایل resolv.conf توی لینوکس سر و کلش پیدا می‌شه‌. شما با
استفاده از این فایل می‌تونین به لینوکس‌تون بفهمونید که از چه DNS
Server‌ای استفاده کنه تا در خطر نباشین‌ (‌این کار رو اگه روترتون ازش
پشتیبانی کنه می‌شه توی خود روتر هم انجام داد ;-))</p>
<h4></h4>
<p>مزیت استفاده از DNSCrypt</p>
<p>بزرگترین و بهترین مزیتش اینه که ما رو به صورت کاملا امن به سرور‌های
OpenDNS وصل می‌کنه‌، و دیگه ارتباطمون با DNS Server غیر قابل شنود
می‌شه‌. یعنی اگه شخص خرابکاری روی اینترنتمون باشه‌، باید اول با کدگذاری
DNSCrypt بجنگه تا دستش به ما برسه‌!</p>
<h4></h4>
<p>نصب روی اسلکور (‌و اکثر توزیع‌ها‌)</p>
<p>خیلی راحت‌، اول با دستور زیر فایل‌ها رو می‌گیریم‌:</p>
<pre class="code bash"><a name="rest_code_2d0ca114dadb435d97c5e37fb8ea78d5-1"></a>git clone git://github.com/opendns/dnscrypt-proxy.git
</pre>
<p>بعد وارد پوشه می‌شیم و دستورات زیر رو به ترتیب می‌زنیم‌:</p>
<pre class="code bash"><a name="rest_code_8cde3f46ed474167a7052e83122ba9c0-1"></a>./autogen
<a name="rest_code_8cde3f46ed474167a7052e83122ba9c0-2"></a>
<a name="rest_code_8cde3f46ed474167a7052e83122ba9c0-3"></a>./configure
<a name="rest_code_8cde3f46ed474167a7052e83122ba9c0-4"></a>
<a name="rest_code_8cde3f46ed474167a7052e83122ba9c0-5"></a>make -j4
</pre>
<p>که اون ‏‎-j4 منظورم اینه که از همه زور CPUم استفاده کن (‌اگه شما CPUتون
چهار هسته‌ای نیست می‌تونین تعداد هسته خودتون رو جای چهار بزارین یا کلا
تگ j رو بیخیال شین) حالا برای این که وقتی دلمون خواست پاکش کنیم این کار
رو می‌کنیم‌ (مخصوص اسلکور):</p>
<pre class="code bash"><a name="rest_code_8bb70941567e4187a2d076f60f394bd6-1"></a>mkdir /tmp/dnscrypt
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-2"></a>
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-3"></a>make install <span class="nv">DESTDIR</span><span class="o">=</span>/tmp/dnscrypt
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-4"></a>
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-5"></a><span class="nb">cd</span> /tmp/dnscrypt
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-6"></a>
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-7"></a>makepkg -l y -c n /tmp/dnscrypt.tgz
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-8"></a>
<a name="rest_code_8bb70941567e4187a2d076f60f394bd6-9"></a>installpkg /tmp/dnscrypt.tgz
</pre>
<p>توی باقی توزیع‌ها تنها کافیه بزنین make install ولی خوب پاک کردنش پای
خودتونه!</p>
<h5></h5>
<p>کار با DNSCrypt</p>
<p>برای کار باهاش اول اون رو با دستور زیر فعال می‌کنیم‌:</p>
<pre class="code bash"><a name="rest_code_f213c3c8c0584dc68e4f534de6083d39-1"></a>/usr/local/sbin/dnscrypt-proxy -d
</pre>
<p>و اگه دلتون نمی‌خواد بعد از هر بار ری‌استارت دوباره این دستور رو بزنین‌،
فقط کافیه توی فایل ‏‎/etc/rc.d/rc.local همین دستور بالا رو اضافه کنین‌.</p>
<p>و در آخر با اضافه کردن خط زیر توی ‎/etc/resolv.conf به لینوکستون بگین که
از 127.0.0.1 به عنوان DNS Server استفاده کنه‌:</p>
<pre class="code bash"><a name="rest_code_0f73b0aa940f42d391eda9ffb10bc88f-1"></a>nameserver 127.0.0.1
</pre>
<p>حواستون باشه که nameserver قبلی رو با اضافه کردن یه # کامنت کنین‌! حالا
با مرورگرتون (‌و بدون استفاده از پروکسی‌) این صفحه رو ببینین‌. احتمالا
بهتون تبریک می‌گه که از OpenDNS استفاده می‌کنین ;-)</p>
<h5></h5>
<p>حل یک مشکل:</p>
<p>احتمالا بعد از اولین ریبوت می‌فهمین که فایل resolv.conf‌تون دوباره عوض
شده و آدرس قبلی توش نیست‌! این به دلیل استفاده از dhcpcd هست که تنظیمات
این فایل رو بعد از هر بار شناسایی آی پی روتر دوباره‌نویسی می‌کنه‌. خوب
حالا چاره چیه‌؟ هیچی دستور زیر رو می‌زنیم:</p>
<pre class="code bash"><a name="rest_code_2ac5db0c60484fd78f0c2c77ab969ccf-1"></a>chattr +i /etc/resolv.conf
</pre>
<p>که یعنی دست خر کوتاه‌! (‌یعنی هیچ‌کس غیر از صاحب فایل حق دست زدن بهش رو
نداشته باشه‌)  در مورد این که این دستور دقیقا چی کار می‌کنه می‌تونین به
این مطلب از علی عزیز در آکلینوکس رجوع کنین ;-)</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="blog13901127zsh-dwst-shmstwp.html" rel="prev" title="Zsh دوست شماست‌! .. date: 2012/2/16 2:4:41">ارسال پیشین</a>
            </li>
            <li class="next">
                <a href="blog13901204byyyd-jmh-azd-khwd-r-drkh-khnymwp.html" rel="next" title="بیایید جامعه آزاد خود را درک کنیم .. date: 2012/2/23 22:33:39">ارسال بعدی</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>دیدگاه‌‌‌ها</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="shahinism",
            disqus_url="http://5hah.in/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhshwp.html",
        disqus_title="dnscrypt \u0631\u0648\u06cc \u0627\u0633\u0644\u06a9\u0648\u0631 (\u200c\u0648 \u0628\u0627\u0642\u06cc \u0644\u06cc\u0646\u0648\u06a9\u0633\u200c\u0647\u0627\u200c) .. date: 2012/2/19",
        disqus_identifier="cache/posts/new/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhsh.wp.html",
        disqus_config = function () {
            this.language = "fa";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="shahinism";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2015         <a href="mailto:me@5hah.in">شاهین آزاد</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>

            <script src="../../assets/js/all-nocdn.js"></script><script src="../../assets/js/colorbox-i18n/jquery.colorbox-fa.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("fa");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
