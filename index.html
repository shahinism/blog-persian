<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="wot-verification" content="1e0ce5594a67af53269c">
<base href="https://5hah.in/">
<meta name="description" content="Sometimes you gotta run before you can walk">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>شاهین</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://5hah.in/">
<link rel="next" href="index-24.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/version-control-is-not-optional/" type="text/html">
</head>
<body>
  <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

  <div class="navigator">
    
  </div>

  <nav class="navbar navbar-default"><div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="."><img src="assets/images/logo.png"></a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
<li>
<a href="stories/about-me">درباره</a>
                </li>
<li>
<a href="docs/resume.pdf">رزومه</a>
                </li>
<li>
<a href="archive.html">آرشیو</a>
                </li>
<li>
<a href="categories/">دسته‌ها</a>
                </li>
<li>
<a href="rss.xml">خوراک</a>

                    
        </li>
</ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
  </nav><div class="jumbotron">
    <section class="container"><div id="headerbox" class="col-md-6 col-md-offset-3 text-center">
        <h1>شاهین</h1>
        <hr class="hdrline">
<a class="social" href="https://github.com/shahinism">
          <img src="assets/images/github.png"></a>
        <a class="social" href="https://twitter.com/shahinism">
          <img src="assets/images/twitter.png"></a>
        <a class="social" href="https://ir.linkedin.com/in/shahinism">
          <img src="assets/images/linkedin.png"></a>
      </div>
    </section>
</div>

  <div class="container" id="content" role="main">
    <!--Body content-->
    <div class="col-md-6 col-md-offset-3">
      <div class="row">
        
<div class="postindex">
    <article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/version-control-is-not-optional/" class="u-url">ورژن کنترل اختیاری نیست!</a></h1>
            شاهین
      <a href="posts/version-control-is-not-optional/" rel="bookmark"><time class="published dt-published" datetime="2015-12-27T10:49:45+03:30" title="2015-12-27 10:49">2015-12-27 10:49</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>حقیقتش انتظار داشتم این موضوع خیلی وقت پیش حل شده باشد. حتی پیش خودم فکر می‌کردم که ورژن کنترل یک جورهایی جزء غرایض جامعه‌ی نرم‌افزاری است‌، آن هم با درجه‌ی اهمیتی مثل نفس کشیدن. دوستی دارم که حدوداً دو سال پیش روی دیوار فیس‌بوک‌اش از پاک شدن اتفاقی فایل‌های یکی از پروژه‌هایش شکایت کرده بود‌، که وا مصیبتا‌، مسلمانان چه نشسته‌اید که نتیجه‌ی تلاش چند سال گذشته‌ام به فنا رفت!</p>
<p>یادم می‌آید‌‌‌ همان موقع با یک لحن خیلی مودبانه پرسیدم «مگه از ورژن کنترل استفاده نمی‌کردی؟ خوب خطرناکه حسن…» و جوابی در این حدود‌ها گرفتم که «چون این پروژه‌ها یا شخصی بودن یا کوچیک‌، زیاد مباحث مهندسی نرم‌افزار رو توشون رعایت نکردم!». خوب اینکه می‌گویم دوست شاید‌، خیال بد کنید‌، ولی خوب خوشبختانه چند سالی هست که حسن را از نزدیک ملاقات نکرده‌ام‌، وگرنه احتمالاً آن موقع نمی‌توانستم خودم را کنترل کنم و ایشان را به کما می‌فرستادم تا این مشکل دوباره برایش تکرار نشود.</p>
<p>دوباره؟ بله دوباره‌، چند هفته‌ی پیش بود که این حسن آقای گل پستی همراه با نفرین و ناله علیه چند تن از رفقای نزدیک‌ترش نوشت که چرا مجبورش کردند که ویندوز (نه انگار باید در این رفاقت جدا تجدید نظر کرد ;))) عوض کند (یا یک بلایی سر ویندوزش آوردند یا همچین چیزهایی) و فایل‌های دو تا از پروژه‌هایش به فنا رفته…</p>
<p>البته یک بار خیال برتان ندارد که حسن تازه‌کار است و یا از این حرف‌ها… هر چند هم که ویندوزی باشد، یکی از خلاق‌ترین توسعه دهنده‌های PHP است که می‌شناسم.</p>
<p>ماجرا البته به حسن ختم نمی‌شود. دوست دیگری دارم که ارشد نرم‌افزار خوانده و ورژن کنترل را فقط از دهان من در دوره‌ی کارشناسی‌اش شنیده‌. یا سال گذشته در حال استفاده از نرم‌افزار اتوماسیون صنعتی یکی از شرکت‌های مطرح این زمینه در محل کارم‌، متوجه شدم که نسخه‌های مختلفشان را با فایل‌های زیپ مدیریت می‌کنند. فکرش را بکنید‌، مثلاً می‌خواستند یک آپدیت بدهند‌، باید هماهنگ می‌شد تکنسینشان در محل شرکت حاضر شود‌، پشت سرور بنشیند‌، فایل زیپ را دانلود و روی پوشه‌ی قبلی overwrite کند‌، تا آپدیت داشته باشیم. این روند البته همانطور که گفتم پروژه‌ی دانشگاهی نبود‌، شرکتی مطرح در حوزه‌ی نرم‌افزار کشور‌، پروژه‌ی ‎.Net می‌نوشت و آن را این‌طور به مشتری می‌رساند (که البته معلوم است خرج دوبله‌اش را از جیب مبارک مشتری کسر می‌کرد). این پروژه حتی مشتری خارجی هم داشت (تا جایی که یادم می‌آید از ترکیه) به هر حال خواستم بگویم:</p>
<div class="section" id="id1">
<h2>ورژن کنترل اختیاری نیست:</h2>
<p>مهم نیست پروژه چقدر کوچک است‌، مهم نیست چقدر کم اهمیت است، مهم نیست شما چقدر کارتان درست است. همین دلیل کفایت می‌کند «اگر همین الان اتفاقی فایل‌ها پاک شد‌، احساس تأسف می‌کنید؟» اگر آره‌، پس استفاده از ورژن کنترل اجباریست! تعارف که نداریم، در توسعه‌ی نرم‌افزار هر چقدر هم این‌کاره باشیم‌، باید بار‌ها اشتباه کنیم تا بتوانیم به نتیجه‌ی دلخواه برسیم. مجبوریم راه‌هایی را امتحان کنیم که قبلاً کسی نرفته، بار‌ها حتی مسیری که خودمان رفته‌ایم را عوض کنیم… جدا چه چیزی قشنگ‌تر از ورژن کنترل می‌تواند کمک کند؟</p>
</div>
<div class="section" id="id2">
<h2>ورژن کنترل تنها محدود به توسعه نرم‌افزار نیست:</h2>
<p>دارید کتاب می‌نویسد؟ مقاله؟ پایان نامه‌ی دانشگاه‌تان؟ اوه شما طراحید؟ سر و کارتان فقط با HTML و CSS است؟ ‌ گرافیستید؟ مهم نیست، تا جایی که پروژه‌تان بتواند در قالب یک ورژن کنترل توسعه پیدا کند‌، استفاده از آن لطف بزرگی به خودتان است.</p>
</div>
<div class="section" id="id3">
<h2>ورژن کنترل فقط برای توسعه نیست:</h2>
<p>در <a class="reference external" href="http://foundersbuddy.com">فاندرز بادی</a> ما از ورژن کنترل برای دیپلوی هم استفاده می‌کنیم. این است که حتی اگر چیزی را اشتباها دیپلوی کنیم، برای برگشتش دو ثانیه وقت نیاز است! راستش این قضیه یک بار اتفاق هم افتاد. در حین دیپلوی تغییرات جدید سایت‌، یک ویژگی که هنوز کامل نشده بود هم اشتباهاً روی سایت قرار گرفت… این هم کاری که کردیم:</p>
<img alt="https://dl.dropboxusercontent.com/u/25017694/Blog-photos/Screenshot%20at%202015-12-26%2023%3A08%3A26.png" src="https://dl.dropboxusercontent.com/u/25017694/Blog-photos/Screenshot%20at%202015-12-26%2023%3A08%3A26.png"><p>خوب حالا اگر موافق بحث اصلی متن هستید‌، احتمالاً می‌خواهید بدانید:</p>
</div>
<div class="section" id="id4">
<h2>کدام ورژن کنترل؟</h2>
<p>جواب کوتاه Git، و بلندش اینکه هر کدامی که دلتان خواست. گیت برای من تا الان انتخاب خوبی بوده و هرگز فایلی نداشته‌ام که مرز ۵۰ مگابایتی‌اش را رد کند. ولی اگر این سناریوی شماست‌، احتمالاً راه حل‌های خوب دیگری هم بتوانید پیدا کنید.</p>
</div>
<div class="section" id="id5">
<h2>از کجا شروع کنیم؟</h2>
<p>اگر انتخابتان گیت است‌، و کمی با کلاً بحث ورژن کنترل آشنایی دارید‌، <a class="reference external" href="http://try.github.com">این آموزش پویا</a> احتمالاً کارتان را راه بیاندازد. اگر هم این کاره‌اید و یا می‌خواهید سر تا پای این ابزار دوست‌داشتنی را بشناسید، <a class="reference external" href="http://udacity.com">Udacity</a> یک <a class="reference external" href="https://www.udacity.com/course/how-to-use-git-and-github--ud775">دوره‌ی فوق‌العاده عالی</a> دارد. اگر توانستید فیل‌تر گوگل احمق برای <a class="reference external" href="http://udacity.com">Udacity</a> و تامین کننده اینترنت احمق‌ترتان را برای Youtube بردارید‌، احتمالاً از دیدنش لذت خواهید برد.
و البته <a class="reference external" href="http://navid.kashani.ir">نوید</a> هم <a class="reference external" href="http://navid.kashani.ir/549/git-commit-good-practice/">پست خیلی خوبی</a> برای بهتر کردن تجربهٔ استفاده از ورژن کنترل دارد که می‌تواند استفاده از گیت را برای‌تان خیلی خوشمزه‌تر کند ;) همینطور اگر از کافران ویندوزی هستید‌، <a class="reference external" href="http://navid.kashani.ir/tag/%DA%AF%DB%8C%D8%AA/">برچسب گیت</a> مطالبش را از دست ندهید…</p>
</div>
<div class="section" id="id6">
<h2>اضافه:</h2>
<p>اگر کاربر ایمکس هستید‌، <a class="reference external" href="http://magit.vc/">magit</a> را از دست ندهید. تجربه‌ی کار با گیت را برایتان واقعاً دلنشین می‌کند. اگر هم مثل من که به تازگی کوچ کرده‌ام (جهت تغییر آب و هوا البته) از <a class="reference external" href="https://atom.io">atom</a> استفاده می‌کنید‌، <a class="reference external" href="https://atom.io/packages/git-plus">git-plus</a> همان امکان را به ارمغان می‌آورد.</p>
</div>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/version-control-is-not-optional/#disqus_thread" data-disqus-identifier="cache/posts/version-control-is-not-optional.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/no-space-mysql-problem/" class="u-url">وقایع نگاری یک دیباگ: وقتی MySQL چیزی ذخیره نمی‌کند!</a></h1>
            شاهین
      <a href="posts/no-space-mysql-problem/" rel="bookmark"><time class="published dt-published" datetime="2015-11-16T19:15:57+03:30" title="2015-11-16 19:15">2015-11-16 19:15</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>مشکل از آن‌جا شروع شد که <a class="reference external" href="http://navid.kashani.ir/">نوید</a> خبر داد که چند ساعتی است یک وبلاگ وردپرسی که برای یکی از <a class="reference external" href="http://foundersbuddy.com">پروژه‌هاست</a> ، عکس‌العمل‌های عجیب و غریب نشان می‌دهد! چطور؟ این که باکس متن بعضی از مطالب نشان داده نمی‌شوند. اولین حدسم این بود که شاید بخاطر تغییرات اخیری که در آدرس وبلاگ داده بودم همچین مشکلی پیش آمده و خواستم که تنظیمات را به حالت قبل برگردانند… و مشکل یپچیده‌تر شد! چطور؟ تنظیمات جدید ذخیره نمی‌شد.</p>
<p><a class="reference external" href="http://navid.kashani.ir/">نوید</a>  چند تایی روش پیشنهاد کرد تا شاید بتوانیم اطلاعات بیشتر در رابطه با وضعیت به دست بیاوریم. به سرور لاگین می‌کنم و… tab completion کار نمی‌کند. یک همچین اخطاری می‌دهد:</p>
<pre class="code bash"><a name="rest_code_26e5ca91c6fb43bc8d756d0080c1e937-1"></a>bash: cannot create temp file <span class="k">for</span> here-document: No space left on device
</pre>
<p>خوب راست هم می‌گوید انگار… یک <cite>df -h</cite> معلوم می‌کند که پوشهٔ home کاربر حاضر‌، تا خرخره پر شده. یک فایل log که از <a class="reference external" href="http://5hah.in/posts/multithreading-bug-experiment-on-PyMongo-driver.html">دیباگ</a> قبلی باقیمانده، وزنش به ۵ گیگ رسیده و دیگر نمی‌تواند نفس بکشد.</p>
<pre class="code bash"><a name="rest_code_0b232d5662214262aa323acbbc0f4fd8-1"></a>rm -rfv PATH_TO_FAT_FILE
</pre>
<p>و دوباره <cite>df -h</cite>… و؟ فضا خالی نشده. فایل پاک نشده؟ <cite>ls -lh PATH_TO_FAT_FILE</cite> می‌گوید که همچین فایلی نداریم. ها از قرار آن پروسهٔ لاگ همچنان فعال است (این‌طوری سیستم فایل فضایش را بعد از پاک کردن فایل مذکور به روز نمی‌کند). پروسه چه بوده حالا؟ Only GOD knows :)</p>
<pre class="code bash"><a name="rest_code_a9842c134af44e38a087882ece5b9f9f-1"></a>ps -aux <span class="p">|</span> grep PATH_TO_FAT_FILE
</pre>
<p>امیدوار بودم که با شل پایپ کرده باشند که نه انگار… می‌دانم کار کیست ولی او هم به خاطر نمی‌آورد که دستور چه بوده. هوم… لینوکس دیگر اینقدر‌ها هم بی‌شعور نیست. راه حل خودش چیست؟ <cite>lsof</cite></p>
<pre class="code bash"><a name="rest_code_3d5de8e08980466a9abcf3f832770522-1"></a>lsof PATH_TO_FAT_FILE
</pre>
<p>حل شد؟ نه! همچین پروسه‌ای نداریم. یک کم پرزورتر می‌پرسیم:</p>
<pre class="code bash"><a name="rest_code_5e59d981490142aa9d101e61255dbeab-1"></a>sudo !!
</pre>
<p>ها ها، پیدا شد! یک <cite>kill -9</cite> مهمانش کردیم و حالا باید مشکل حل شده باش. ولی…</p>
<pre class="code bash"><a name="rest_code_b3b9e08bd39d48a2a7eab5b9dca3446b-1"></a>bash: cannot create temp file <span class="k">for</span> here-document: No space left on device
</pre>
<p>هوم… باز هم؟ می‌گوید temp، حالا اگر فرض بگیریم مثل آدم این‌جور فایل‌ها را در ‎/tmp ذخیره می‌کند، ۱.۵ گیگابایت فضای خالی داریم. پس این اخطار برای چیست؟ قضیه آن‌جا عجیب می‌شود که یک عالمه (عدد جدید است. یک کم بیشتر از خیلی زیاد :)) فایل یک کیلوبایتی داخل ‎/tmp ذخیره شده. محتوایش؟ چیز خاصی نیست. ولی چه ربطی می‌تواند به مشکل داشته باشد؟ کمی جستجو  و <cite>df -i</cite>:</p>
<pre class="code bash"><a name="rest_code_b5ea5ef26e894f9498bd4a2a0f24b58e-1"></a>...
<a name="rest_code_b5ea5ef26e894f9498bd4a2a0f24b58e-2"></a>tmpfs                             494K    494K   <span class="m">0</span>    100% /tmp
<a name="rest_code_b5ea5ef26e894f9498bd4a2a0f24b58e-3"></a>...
</pre>
<p>که چه؟ inode پر است؟ چی هست اصلا؟ به نقل از <a class="reference external" href="https://en.wikipedia.org/wiki/Inode">ویکی‌پدیا</a>:</p>
<blockquote>
آی‌نود (به انگلیسی: inode) به ساختمان داده‌هایی گفته می‌شود که در سیستم‌فایل‌های شبیه به یونیکس مانند UFS استفاده می‌شود. یک inode اطلاعات پایه‌ای در مورد فایل‌ها، دایرکتوری‌ها و اشیاء دیگر موجود در فایل‌سیستم را در خود نگهداری می‌کند.</blockquote>
<p>و خوب طبیعی است. اگر این فضا پر شده که دستور قبل همچین چیزی نشان می‌دهد، امکان ساختن فایل جدید وجود ندارد. یک find خوشگل سر هم می‌کنیم که همهٔ فایل‌های با اسم عجیب غریب یکسانشان را باطل کند. (در پست بعدی جریان این فایل‌ها را شرح می‌دهنم):</p>
<pre class="code bash"><a name="rest_code_e5a16eee646041709da07130db792306-1"></a>find -regextype posix-egrep -type f -regex <span class="s1">'.*[^/]{40}'</span> -delete
</pre>
<p>خیلی ساده یعنی هر فایلی که طول اسمش دقیقا ۴۰ کاراکتر است را پاک کن. و تست دوباره‌، auto completion به کار افتاده. خوب اصلا برای چه لاگین کرده بودیم؟ مشکل دیتابیس MySQL و وردپرس بود. یک بار دیگر صفحه را باز کنیم تا ببینیم دقیقا چه اتفاقی می‌افتد… و… عه؟ مشکل حل شده! بریم ببینیم تنظیمات جدید را ذخیره می‌کند؟ ها‌، آره آن هم حل شده. ضرب‌المثل ربط … به … این‌جا خیلی قشنگ صدق می‌کند :)</p>
<p>به هر حال چند تا درس گنده یاد گرفتم، همچین باگ‌هایی ارزش یک کلاس درس واقعی را دارند‌، این‌طور نیست؟</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/no-space-mysql-problem/#disqus_thread" data-disqus-identifier="cache/posts/no-space-mysql-problem.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/multithreading-bug-experiment-on-PyMongo-driver/" class="u-url">وقایع نگاری یک دیباگ: وضعیت عجیب MongoDB</a></h1>
            شاهین
      <a href="posts/multithreading-bug-experiment-on-PyMongo-driver/" rel="bookmark"><time class="published dt-published" datetime="2015-11-09T09:58:21+03:30" title="2015-11-09 09:58">2015-11-09 09:58</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>استفاده از Mongo و Python برای ایجاد یک RESTFUL API دیگر آن‌چنان هم سناریوی دور از انتظاری نیست، خصوصا این که اگر کمی جستجو کنید می‌بینید که افراد زیادی اشاره به پایداری و Performance همچین استکی می‌کنند و راه‌کار‌های بسیار زیادی نیز برای بهتر کردن آن ارائه کرده‌اند. در یکی از پروژه‌های تیم <a class="reference external" href="http://www.foundersbuddy.com/">فاندرز</a> ما هم با استکی به شرح زیر، RESTFUL API مربوط به اپلیکیشمان را طراحی‌کرده‌ایم:</p>
<ul class="simple">
<li><a class="reference external" href="http://mongodb.org">Mongo</a></li>
<li>Python 3</li>
<li><a class="reference external" href="http://api.mongodb.org/python/">PyMongo</a></li>
<li><a class="reference external" href="http://djangoproject.com">Django</a></li>
<li><a class="reference external" href="http://memcached.org">Memcached</a></li>
<li><a class="reference external" href="https://uwsgi.readthedocs.org/">uWsgi</a></li>
<li><a class="reference external" href="http://nginx.com">Nginx</a></li>
</ul>
<p>در چهار ماه اول لانچ API، هیچ مشکلی در داده‌های دریافتی و پردازش‌های مورد نیاز مشاهده نمی‌شد. Performance کلی استک هم در حد قابل قبولی جواب‌گوی نیاز‌ها بود. تا این که با تغییری در نحوهٔ ارائهٔ خدمات پروژهٔ اصلی‌، حجم کاربران سرویس به نحو چشم‌گیری بالا رفت و ماجرا آغاز شد!</p>
<p>مشکل ایجاد شده‌، نه در Performance سیستم بود و نه حتی می‌توان گفت که پایداری API زیر سوال رفته بود. قضیه از این قرار بود که درخواست‌هایی که منجر به خواندن داده از پایگاه دادهٔ سرویس بود‌ (Mongo) در زمان‌های خاصی از روز‌ (که عمدتا تایم شلوغی برای پروژه بود) تنها تکه‌ای از داده‌های مورد انتظار را بر می‌گرداندند. برای مثال اگر ما انتظار داشتیم که کوئری X روی دیتابیس‌، شامل ۲۰ سند (Document منظور آبجکت‌های دیتابیس Mongo است) باشد‌، بعضی از درخواست‌ها نتیجه‌ای در بازه‌ای کوچکتر از ۲۰ را بر می‌گرداند.</p>
<p>قضیه جایی بحرانی می‌شد که این نتیجه را برای یک بازهٔ زمانی مشخص Cache می‌کردیم، و خوب در صورت خراب شدن یکی از این کوئری‌ها‌، کاربران در آن مدت‌، نتیجهٔ ناقص را مشاهده می‌کردند. جدای از این، هیچ ضعف مشخصی از سیستم برای تراکنش‌ها مشاهده نمی‌شد.</p>
<!-- TEASER_END -->
<p>حدس اولیه می‌توانست خود سیستم کش (Memcached) باشد. ولی همانطور که اگر با Mongo کار کرده باشید می‌دانید‌، داده‌ها در این دیتابیس به صورت JSON ذخیره می‌شوند‌، و ما حتی در نتایج ناقص دریافتی‌، هیچ سند ناقصی نمی‌دیدیم. نتایجی که نهایتا توسط Django به صورت JSON سرو می‌شدند هم کاملا ولید بودند. از طرف دیگر‌، وقتی سعی می‌کردیم با اجرای متد <cite>‎.count()‎‍</cite> روی Cursor دریافتی از Mongo نتایج دریافت شده را بسنجیم‌، نتایع دقیقا همان مشکلی را داشتند که ما در خروجی JSON جانگو می‌دیدیم.</p>
<p>پس از مدتی جستجو و نیافتن نتیجهٔ خاصی‌، سعی کردیم بتوانیم مشکل را باز تولید کنیم تا شاید با بررسی لاگ‌ها بتوانیم‌، علت آن را پیدا کنیم. <a class="reference external" href="http://amirbitaraf.ir/">امیر</a> یکی از اعضای پروژه‌، با پایتون اسکریپتی نوشت که به صورت Multithread ریکوئست‌هایی را به سمت Endpoint‌هایی که این مشکل را در آن‌ها مشاهده کرده بودیم ارسال کند تا شاید مشکل سریع‌تر بروز کند. ساختار کلی این اسکریپت بسیار ساده بود‌، و درست یا اشتباه بودن نتایج را با استفاده از Parse کردن نتیجهٔ JSON دریافتی‌، شمارش تعداد آبجکت‌ها و مقایسه با نتیجهٔ مورد نظر انجام می‌داد.(بدیهی است که در زمان بررسی دیگر از Cache استفاده نمی‌کردیم :))</p>
<p>هر بار که اسکریپت را اجرا می‌کردیم، چیزی حدود ۳-۴ ساعت زمان لازم بود تا اولین نتایج اشتباه را دریافت کنیم. و بعد از اولین مشاهدهٔ نتایج اشتباه‌، به سرعت تعداد این نتایج زیاد می‌شد تا این که ۸۰٪ نتایج دریافتی را شامل می‌شد. یعنی ۳ ساعت هیچ مشکلی نداشتیم‌، بعد در عرض ۱۰ دقیقه‌، ۸۰٪ نتایج ناقص می‌شدند. حالا این وضعیت را چطور رفع کنیم؟‌ کافی بود uWSGI را ری استارت کنیم‌، تا برای یک مدت طولانی دیگر، نتایج کاملا درست بگیریم.</p>
<p>این قضیه ری‌استارت کردن uWSGI باعث شد‌، به پروسه‌های اجرا شده توسط آن مشکوک شویم. پس سعی کردیم مشکل را در تنظیمات uWSGI پیدا کنیم. یکسری تغییرات مثل کم کردن تعداد پروسه‌های در حال اجرا‌ و یا respawn کردن پروسه‌ها بعد از ۵۰۰۰ درخواست‌، نتایج را کمی بهتر کرد. ولی باز هم بعد از گذشت چیزی در حدود ۸ ساعت‌، مشکل را مشاهده می‌کردیم.</p>
<p>حتی در اقدامی‌، که بعد از بررسی دقیق کد‌های <a class="reference external" href="http://api.mongodb.org/python/">PyMongo</a> توسط <a class="reference external" href="http://amirbitaraf.ir/">امیر</a> رخ داد‌، سعی کردیم به طور مستقیم Cursorهای دریافتی <a class="reference external" href="http://api.mongodb.org/python/">PyMongo</a> را هر کجای کد که دیگر نیازی بهشان نداریم close()‎ کنیم. یا همانطور که در مستندات <a class="reference external" href="http://api.mongodb.org/python/">PyMongo</a> اشاره شده‌، تنها از یک MongoClient در سراسر کد استفاده کنیم تا خود درایور بتواند به درستی Thread safety کوئری‌های را فراهم کند. نتیجه این شد که یک بار در یک بازهٔ طولانی ۴۸ ساعته‌، هیچ مشکلی در سیستم ندیدیم و بعد‌، دوباره، روز از نو…</p>
<p>در این مرحله سعی کردیم مساله را جمع‌بندی کنیم و از دیگران راهنمایی بگیریم. طرح مساله در <a class="reference external" href="http://stackoverflow.com/questions/33234204/pymongo-find-query-returns-empty-partial-cursor-when-running-in-a-djangouwsgi-p">Stackoverflow</a> ، چند گروه ایمیلی‌، تماس مستقیم با اشخاص مطلع در این خصوص و حتی مشاوره اسکایپی با یک نفر که از <a class="reference external" href="http://hackhands.com">Hackhands</a> پیدا کرده بودیم، از جملهٔ این درخواست راهنمایی‌ها بود. نتیجه؟ خوب نتایج در نوع خودشان عالی بودند:</p>
<ol class="arabic simple">
<li>بعضی‌ها مشکل را درست درک نمی‌کردند و خوب طبیعی بود‌، چون اگر این مشکل آن‌چنان فراگیر بود‌، مطمئنا منابع زیادی می‌شد در خصوصش روی اینترنت پیدا کرد.</li>
<li>بعضی‌ها که در واقع جزء با مرام‌های دستهٔ اول بودند‌، سعی می‌کردند بهمان نشان بدهند که اگر خودشان در این موقعیت گیر می‌کردند‌، از چه روش‌هایی برای دیباگ کردن قضیه استفاده می‌کردند.</li>
<li>بعضی‌ها می‌گفتند‌، کلا استفاده از Mongo اشتباه است و کاش MySQL بود (نه باور کنید دقیقا همین جایگزین). یا چه می‌دانم‌، پایتون؟ نه آقا شوخی نکنید‌، فقط Nodejs جواب مساله است.</li>
</ol>
<p>کمک‌های دستهٔ دوم‌، بسیار ارزشمند بود‌، خصوصا این که برای جاهای مختلف استک‌، با یک دوجین ابزار دیباگ مختلف آشنایمان کرد که حداقل نه برای پیدا کردن جواب مساله‌، ولی برای تست تئوری‌های‌مان بسیار کمک کننده بود.</p>
<p>ولی راهنمایی‌های دستهٔ سوم که شامل تغییر یکی از اعضای استک‌، بدون دانستن این که مشکل به وجود آمده در کجای استک رخ داده‌، جدای از این که تایم زیادی می‌خواست و معلوم نبود بتواند مشکل را به صورت ۱۰۰٪ حل کند‌، نمی‌توانست حس کنجکاوی دولوپر‌های تیم را ارضا کند. بماند که به قولی تغییر صورت مساله بود و رسما در فرهنگ لغت <a class="reference external" href="https://nl.linkedin.com/in/ashkanroshanayi">اشکان</a> (لیدر تیم) جایی ندارد :)</p>
<p>نا امید از این که نتوانسته بودیم حتی یک اشارهٔ کوچک در رابطه با این که مشکل اصلی کجای استک دارد رخ می‌دهد پیدا کنیم‌، سعی کردیم‌، سرویس را روی سرور ضعیف‌تری که داشتیم اجرا کنیم و وضعیت را روی آن بررسی کنیم. با این تفاوت که کلیه کانفیگ‌ها را خودمان انجام داده‌ایم و از ریز به ریز جزئیات تراکنش‌ها می‌توانیم در یک محیط ایزوله‌تر لاگ بگیریم. نتیجه؟ در بیشترین فشار ممکن‌، حتی یک نتیجهٔ ناقص هم دریافت نکردیم! CPU این سرور فوق‌العاده ضعیف‌تر بود و تعداد پروسه‌ها برابر با سرور اصلی. اما هیچ نتیجهٔ ناقصی نمی‌دیدیم!</p>
<p>این در حالی بود که حتی با خارج کرد uWSGI از استک و اجرای سرویس با سرور توسعهٔ Django، بعد از ۱۰-۱۲ ساعت‌، مشکل را مشاهده می‌کردیم. پس از جستجوی بیشتر حقیقتش دیگر داشتیم کم کم راضی می‌شدیم که به نصایح دسته سومی‌ها عمل کنیم! چرا که سرویس دیگری برای همین پروژه‌، روی همان سرور که دقیقا از همین Mongo دیتا را می‌خواند‌، ولی با یک کش بسیار بلند‌تر ارائه می‌کرد‌، در این مدت داشت مثل ساعت کار می‌کرد.</p>
<p>به عنوان آخرین امید‌، سعی کردیم تیکتی در باب مطرح کردن مشکل روی <a class="reference external" href="https://jira.mongodb.org/browse/PYTHON-1005">Issue tracker</a> پروژهٔ‌درایور پایتون Mongo، باز کنیم تا شاید نتیجه‌ای بگیریم. <a class="reference external" href="https://www.linkedin.com/in/berniehackett">Bernie Hackett</a> توسعه دهندهٔ اصلی درایور به کارت اساین شد و انصافا‌، خیلی خوب و با صبر‌، پیگیری مساله را انجام می‌داد.</p>
<p>حالا دیگر تایم زیادی از مواجهه به مشکل گذشته بود‌ و کاربران پروژه‌، چندین برابر قبل بود. دیگر به جایی رسیده بودیم که حتی بدون کش هم بسیاری از ریکوئست‌ها خراب بود. در بین بحث‌ها Hackett به نکته‌ای اشاره کرد که می‌توانست جواب مساله باشد… البته با چیز‌هایی که از مستندات دیده بودیم و قولی که برای Thread safe بودن مونگو می‌داد‌، بیشتر تیری در تاریکی بود.</p>
<p>قضیه از این قرار است که <a class="reference external" href="http://api.mongodb.org/python/">PyMongo</a>، خصوصا در نسخهٔ ۳ به بعد‌، دیگر آبجکت Cursor را به جای یک آبجکت پایتونی استاندارد‌، برای نتایج کوئری بر می‌گرداند. طوری که Hackett در تیکت اشاره کرده‌، هر باری که به قولی کلیهٔ عناصر این Cursor، پیمایش (Iterate) شوند‌، آبجکت Cursor بسته می‌شود. ما هم تا به الان قضیه دیده‌ایم که نتایج Cursorها کمتر از میزان مورد انتظار ما هستند، ولی نمی‌دانیم دقیقا این نتایج از کجا می‌آیند. اول لیست؟ آخرش؟ آن وسط مسط‌ها؟</p>
<p>این بود که سعی کردیم بی‌خیال کل استک شویم و جور دیگری قضیه را تست کنیم.</p>
<pre class="code python"><a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-1"></a><span class="n">res</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">'key'</span><span class="p">:</span> <span class="s1">'STH'</span><span class="p">})</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-2"></a><span class="n">a_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-3"></a><span class="nb">len</span><span class="p">(</span><span class="n">a_test</span><span class="p">)</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-4"></a><span class="o">&gt;&gt;</span> <span class="mi">25</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-5"></a>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-6"></a><span class="n">b_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-7"></a><span class="nb">len</span><span class="p">(</span><span class="n">b_test</span><span class="p">)</span>
<a name="rest_code_51ffe5e3797f433bae6beac9e63736b6-8"></a><span class="o">&gt;&gt;</span> <span class="mi">0</span>
</pre>
<p>همانطور که انتظار داشتیم‌، بعد از بار اول، دیگر Cursor خالی شده و نتیجه‌ای را در بر نمی‌گیرد. حالا یک کمی قضیه را عوض می‌کنیم:</p>
<pre class="code python"><a name="rest_code_411c88c023e24643bee55f9266001618-1"></a><span class="n">res</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">'key'</span><span class="p">:</span> <span class="s1">'STH'</span><span class="p">})</span>
<a name="rest_code_411c88c023e24643bee55f9266001618-2"></a><span class="n">first_elem</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<a name="rest_code_411c88c023e24643bee55f9266001618-3"></a>
<a name="rest_code_411c88c023e24643bee55f9266001618-4"></a><span class="n">all_elems</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
<a name="rest_code_411c88c023e24643bee55f9266001618-5"></a><span class="nb">len</span><span class="p">(</span><span class="n">all_elems</span><span class="p">)</span>
<a name="rest_code_411c88c023e24643bee55f9266001618-6"></a><span class="o">&gt;&gt;</span> <span class="mi">24</span>
</pre>
<p>حالا می‌دانیم اگر قبل از شروع پیمایش‌، یک بار  متد <cite>next()‎</cite> را صدا کنیم‌، زمان فراخوانی پیمایش‌، آیتم اول دیگر در نتیجه وجود نخواهد داشت! چه می‌شود اگر همین Cursor را تحویل چند Thread مختلف بدهیم؟</p>
<pre class="code text"><a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-1"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 0 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-2"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 1 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-3"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 2 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-4"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 3 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-5"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 4 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-6"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 5 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-7"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 6 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-8"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 7 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-9"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 8 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-10"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad8d0&gt; 9 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-11"></a>[31/Oct/2015 19:30:43]"GET /v1/apps/featured/ HTTP/1.1" 200 34652
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-12"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 0 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-13"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 1 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-14"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 2 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-15"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 3 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-16"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 4 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-17"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 5 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-18"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 6 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-19"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 7 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-20"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 8 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-21"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5ad668&gt; 9 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-22"></a>[31/Oct/2015 19:30:44]"GET /v1/apps/featured/ HTTP/1.1" 200 34652
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-23"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 0 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-24"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 1 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-25"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 3 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-26"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 4 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-27"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 2 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-28"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 5 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-29"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 7 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-30"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 8 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-31"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 9 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-32"></a>&lt;pymongo.cursor.Cursor object at 0x7f6aac5a5320&gt; 6 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-33"></a>[31/Oct/2015 19:30:44]"GET /v1/apps/featured/ HTTP/1.1" 200 34652
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-34"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 0 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-35"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 4 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-36"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 1 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-37"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 5 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-38"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 6 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-39"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 3 15
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-40"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 8 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-41"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 9 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-42"></a>&lt;pymongo.cursor.Cursor object at 0x7f4153a28208&gt; 7 0
<a name="rest_code_5d25c62c47644cd585903cac38bf3c6a-43"></a>[31/Oct/2015 19:20:44]"GET /v1/apps/featured/ HTTP/1.1" 200 34652
</pre>
<p>این نتیجهٔ اجرای ایده روی سیستم ضعیف من است. نتیجهٔ ناقص نمی‌بینیم‌، ولی در سه بار از فراخوانی‌ها‌، بیش از یک Thread به یک Cursor دسترسی پیدا کرده است! این مساله را می‌توان در یک مقیاس خیلی بزرگتر مثل سرور Production این پروژه و آن همه Thread، به نتایج ناقص هم ربط داد… این‌طور نیست؟ جواب <a class="reference external" href="https://emptysqua.re/blog/">A. Jesse Jiryu Davis</a> توسعه دهندهٔ <a class="reference external" href="https://motor.readthedocs.org">Motor</a> (درایور پایتونی و async -بله پایتون هم از این کارها بلد است- :)) تایید همین مطلب است.</p>
<p>خوب چه کار کنیم؟‌ بیاییم، Cursorهایی که کلا Thread safe نیستند‌ را به یک آبجکت پایتونی Thread safe تبدیل کنیم. یک همچین پترنی شاید:</p>
<pre class="code python"><a name="rest_code_0fbb401c011343cdbaf8b40ba4dade86-1"></a><span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">'key'</span><span class="p">:</span> <span class="s1">'STH'</span><span class="p">}))</span>
</pre>
<p>و انگار جواب مساله را پیدا کرده‌ایم. بماند که بعد از این که بار‌ها به در بسته خوردن سر این مساله، اعضای تیم را کمی بد‌بین کرده بود و تا دلشان خواست انتقامشان ر موقع تست تئوری جدید گرفتند (<a class="reference external" href="http://amirbitaraf.ir/">امیر</a> حتی به Multithread پایتون هم رضایت نداد و یک نمونهٔ C++‎ هم از اسکریپت تستش نوشت)‌، API با یک Performance عالی‌، بدون هیچ مشکلی همهٔ تست‌ها را درست رد کرد.</p>
<p>نتیجه؟ یکی از طولانی‌ترین دیباگ‌هایی که تا به الان انجام داده‌ایم‌، به سادگی یک <cite>list()‎</cite> قابل حل بود، ولی در این مسیر‌، طی تبادل نظرات‌، تست تئوری‌ها‌، بررسی‌های کلی استک‌، تجربه‌های زیادی کسب کردیم که نهایتا به بسیار بهتر شدن API نسبت به وضعیت قبل و نه تنها در رابطه با همین مساله منجر شد.</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/multithreading-bug-experiment-on-PyMongo-driver/#disqus_thread" data-disqus-identifier="cache/posts/multithreading-bug-experiment-on-pymongo-driver.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/douglas-crockford-javascript-the-good-parts/" class="u-url">خوبی‌های جاوا اسکریپت؟</a></h1>
            شاهین
      <a href="posts/douglas-crockford-javascript-the-good-parts/" rel="bookmark"><time class="published dt-published" datetime="2015-07-08T15:55:01+04:30" title="2015-07-08 15:55">2015-07-08 15:55</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>خیلی وقت است ننوشته‌ام و حقیقتش همین الان هم زیاد مثل گذشته حس نوشتن ندارم. موضوع
این است که از طرفی چند نفر از شما دوستان در ایمیل‌هایی از من خواستید که باز
بنویسم (راستش اصلا فکر نمی‌کردم کسی آن بیرون به فکر چرایی آپدیت نشدن این وبلاگ
باشد.) که ازشان متشکرم. و از طرف دیگر‌، به دلیل شغل جدیدم‌، و هدف‌مند‌تر شدن
فعالیت‌هایم‌، عمدتا تجربه‌های جدید فوق‌العاده‌ای را مزه‌مزه می‌کنم که دوست ندارم زود
فراموش شوند و فکر می‌کنم بازگویی‌شان در این وبلاگ بتواند کمک کند. این است که:</p>
<p>نمی‌دانم چقدر با JavaScript آشنایی دارید‌، ولی بعید می‌دانم که پی‌اش رفته باشید و
اسم داگلاس کراکفورد (<a class="reference external" href="http://www.crockford.com/">Douglas Crockford</a>) به گوشتان نخورده باشد.</p>
<p>عمدهٔ معروفیت ایشان هم پی کتابی به اسم Javascript the Good Parts شکل گرفته که شاید
برای خیلی‌ها یک جک به نظر برسد. چطور؟</p>
<p>خوب بگذارید این‌طور شروع کنم‌: آشنایی من با جاوااسکریپت به کتاب <a class="reference external" href="http://eloquentjavascript.net/">Eloquent
Javascript</a> بر می‌گردد. و شاید یک آشنایی جزئی با <a class="reference external" href="https://nodejs.org/">Nodejs</a> را بتوان چاشنی
تجربه‌ام با این زبان دانست. حقیقت امر این است که از این زبان عمرا لذت نمی‌بردم. چه
می‌دانم شاید اکثریتش بابت معلوم نبودن ریشهٔ درست و حسابی‌اش مثل زبان‌های دیگر
باشد. شاید همین دلیل اولش باعث شده باشد که بتوان داخل اینترنت هزار و یک گزینهٔ
چرند را به عنوان Best practices این زبان پیدا کرد که متاسفانه در خیلی از کد‌های
منتشر شده به این زبان مورد استفاده قرار گرفته‌اند. شاید ساده‌ترین نمونهٔ این‌ها را
بتوان استفاده نکردن از سمی کولون «;» برای پایان دادن به statement‌ها دانست.</p>
<p>دلیلشان ساده است‌، می‌گویند خود مفسر جاوا‌اسکریپت سمی‌کولون‌ها را در جای مناسبشان
می‌گذارد یا حتی بدتر می‌گویند بودن یا نبودن سمی‌کولون در پایان جملات‌، اختیاری
است. این است که ممکن است فاجعه‌ای مانند کد زیر رخ دهد:</p>
<pre class="code javascript"><a name="rest_code_63b1df55964145c8b51776697059914a-1"></a><span class="k">return</span>
<a name="rest_code_63b1df55964145c8b51776697059914a-2"></a><span class="p">{</span>
<a name="rest_code_63b1df55964145c8b51776697059914a-3"></a>    <span class="nx">done</span><span class="o">:</span> <span class="kc">true</span>
<a name="rest_code_63b1df55964145c8b51776697059914a-4"></a><span class="p">}</span>
</pre>
<p>همه چیزش درست به نظر می‌رسد این‌طور نیست؟ اگر این‌طور فکر می‌کنید، یا نقص قضیه را
می‌دانید و به همین دلیل از جاوا اسکریپت بی‌زارید‌، پیشنهاد می‌کنم <a class="reference external" href="http://www.youtube.com/watch?v=hQVTIJBZook">این ارائهٔ</a> آقای
کراکفورد را از دست ندهید.</p>
<p>نکتهٔ کلی در مورد این زبان این است که نقص‌های طراحی فراوان و به صورت بحرانی
مشکل‌زایی را می‌توان در آن یافت. همین‌طور نبود منابع یک‌پارچه با وجود پیاده‌سازی‌های
متنوع (که به قول خود کراکفورد‌، تنها مشکلات طراحی را کپی کردن) باعث کج‌فهمی
برنامه‌نویسانی که فکر می‌کنند می‌توانند این زبان را به راحتی یاد بگیرند شده است.
تمام این‌ها در کنار گستردگی پلتفرمی که تقریبا هیچ زبان دیگری حتی به نزدیکی‌اش هم
نرسیده است (مرورگرها)، و چه می‌دانم شاید امکاناتی که Prototype‌ها به برنامه‌نویس
می‌دهند‌، آن‌چنان نقش تیغ دو لبه را برای برنامه‌نویسان زیبا ایفا می‌کند که نه می‌توان
به کلی از خیرش گذشت (و به قول کراکفورد یادش نگرفت تا موقعی که بهش نیاز داریم) نه
این که بتوان به عنوان یک غول همه چیز تمام برای هر مساله‌ای (سیستم‌عامل NodeJsای رو
که یادتون می‌آد؟) به آن نگاه کرد (دارم به پایتون فکر می‌کنم، ولی اون هم نمی‌تونه
جاهایی که جاوااسکریپت خوب عمل می‌کنه‌، خودی نشون بده).</p>
<a class="reference external image-reference" href="https://xkcd.com/1508/"><img alt="XKCD operation systems" src="https://imgs.xkcd.com/comics/operating_systems.png"></a>
<p>در پایان این ارائه کسی از کراکفورد نظرش را در مورد HTML5 می‌پرسد و حقیقتش یک
جورهایی حرف دلم را می‌زند. تا قبل از HTML5 و یا CSS3 تکلیفمان روشن بود. ساختار را
با HTML و آن DOM چلاغش نشان می‌دادیم. رنگ و لعاب را با CSS می‌گفتیم و هر جینگولک
دیگر را با جاوااسکریپت. حالا HTML5 و CSS3 عمدتا قابلیت‌هایی را به خودشان اضافه
کرده‌اند که قبول دارم داشتنشان با جاوااسکریپت شاید کمی دردسر بیشتری داشت‌، ولی
مربوط به همان حوزه می‌شد و بس. به قول کراکفورد که می‌گوید:</p>
<pre class="code text"><a name="rest_code_221713cda21f43dd986206faf1dc073e-1"></a>It's easy to make things bigger, it's harder to make things better.
</pre>
<p>قبل از پایان مطلب هم دوباره اشاره کنم که همانطور که در متن گفتم‌، من را فعلا
نمی‌توان یک برنامه‌نویس جاوااسکریپت دانست و احتمالا از خیلی از کارهای خارق‌العاده‌ای
که Nodejs می‌تواند بکند بی‌خبرم. هدفم از نوشتن این مطلب برایم حکم ثبت استارت یک
تجربه جدید را دارد. احتمالا در آینده بیشتر در مورد کلنجارهایم با جاوااسکریپت
خواهم نوشت. هر چند بعید می‌دانم به این زودی‌ها دوستش داشته باشم :)</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/douglas-crockford-javascript-the-good-parts/#disqus_thread" data-disqus-identifier="cache/posts/douglas-crockford-javascript-the-good-parts.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/mary-live-codes-a-javascript-game-from-scratch/" class="u-url">کدنویسی بازی جاوااسکریپت به صورت زنده توسط Mary Rose</a></h1>
            شاهین
      <a href="posts/mary-live-codes-a-javascript-game-from-scratch/" rel="bookmark"><time class="published dt-published" datetime="2014-10-08T15:56:04+03:30" title="2014-10-08 15:56">2014-10-08 15:56</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>نمی‌دونم چقدر با جاوااسکریپت آشنایی دارین، ولی جدا زبان فوق‌العاده‌ایه. خصوصا این که پلتفرم جذابی داره‌، اصلا نیاز نیست چیزی کامپایل شه یا برنامه خاصی نصب شه‌، یه مرورگر و تموم، دیگه شمایید و خلاقیتتون. گاها آدم یه چیزایی می‌بینه که بدجوری سر شوق می‌آد (هوم‌! البته این شوق هزار جور می‌شه تفسیر شه‌، حتی از نوع … بی‌خیال!). این ویدئو یکی از اون ویدوئوهای Motivational واقعیه. Mary Rose توی یه کنفرانس و در حدود ۳۰ دقیقه‌، یه بازی جذاب جاوااسکریپتی رو بدون هیچ <span class="strike">فرم‌ویری‌ای</span> فریم‌ورکی برنامه‌نویسی می‌کنه.</p>
<div class="vimeo-video">
<iframe src="https://player.vimeo.com/video/105955605" width="1280" height="720" frameborder="0" webkitallowfullscreen="webkitAllowFullScreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowFullScreen">
</iframe>
</div>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/mary-live-codes-a-javascript-game-from-scratch/#disqus_thread" data-disqus-identifier="cache/posts/mary-live-codes-a-javascript-game-from-scratch.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/the-eudyptula-challenge/" class="u-url">برنامه نویسی کرنل لینوکس با راهنمایی The Eudyptula Challenge</a></h1>
            شاهین
      <a href="posts/the-eudyptula-challenge/" rel="bookmark"><time class="published dt-published" datetime="2014-10-01T20:40:19+03:30" title="2014-10-01 20:40">2014-10-01 20:40</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>عموما کسانی که از گنو/لینوکس به عنوان سیستم‌عامل اصلی‌شان استفاده می‌کنند‌، همه‌اش به خاطر چه می‌دانم‌، فرهنگ آزاد یا روش‌های گیکانه انجام کار‌هایشان نیست. حتی برای باحال‌تر به نظر رسیدن هم نیست. حقیقت این است که ما‌، علاقه به درک بیشتر ابزار‌هایمان داریم. این علاقه گاها آن‌قدر مفید است که پس از یک سر و کله زدن عمیق با یکی از همین ابزار‌ها سر حل یک مشکل خیلی کوچک‌، می‌بینی معادل ساعت‌ها کلاس درس چیز مجانی و خلاقانه‌، آن هم نه تنها در خصوص ابزارت‌، بلکه کل محیط کارت یاد گرفته‌ای.</p>
<p>مهم‌ترین ابزار مورد استفاده ما گنو/لینوکسی‌ها هم خود هسته لینوکس است. نرم‌افزاری که همه هنرش این است‌ که بدون در دست و پا بودنش‌، محیطی برای ارتباط نرم‌افزار‌های دیگر و ماشین‌های مورد استفاده‌مان فراهم کند. همین در دست و پا نبودنش شاید دلیل آن است که کمتر سعی کرده‌ایم بشناسیمش. چه می‌دانم شاید آن‌قدر از خوب بودنش تعریف کرده‌ایم که می‌ترسیم پا در کفش طراحانش کنیم. ولی به هر حال همه که قرار نیست برنامه نویس هسته باشند تا نیاز به فهمیدنش داشته باشند… دانش همیشه خوب است، و دانش در رابطه با ابزار‌هایی که هر روز با آن‌ها سر و کار داریم از آن هم بهتر.</p>
<p>این <a class="reference external" href="http://eudyptula-challenge.org/">The Eudyptula Challenge</a> یک اسکریپت ساده و خنگ دارد به اسم little penguin که همه هنرش این است که ازتان سوال بپرسد و جواب‌های شما را بررسی کند! برایش یک ایمیل می‌فرستید و بعد از این که برایتان راهنمای شروع دوره را فرستاد‌، شروع می‌کند مرحله به مرحله سوال پرسیدن. هیچ راهنمایی هم درکار نیست. خودتان می‌گردید در اینترنت‌، کم کم راه حل را پیدا می‌کنید و یاد می‌گیرد. همچین همه تلاشتان هم باید این باشد که نکند از کسی کمک بگیرید. حقیقتش همینطوری هم هست که چیز یاد می‌گیرید. تنها پیش‌نیاز مورد نیاز‌تان هم آشنایی پایه با زبان C و Make است. (البته این پیش‌نیاز اینطور فکر می‌کند که شما کاربر گنو/لینوکسید و بلدید در طول روز گلیمتان را از آب بکشید)</p>
<p>همین‌جا هم این را اضافه کنم که سرعت کار این اسکریپت پایین است. همین الان ۳۶ ساعت است که جواب سوالش را داده‌ام و هنوز تاییدیه جوابم نیامده. آهان‌، این را هم بگویم که بهتر است از یک کلاینت برای ایمیل استفاده کنید نه رابط کاربری Gmail. ایمیل‌هایتان باید Plain text باشد و فایل‌های پیوستی متن ساده و نه base 64 که Gmail روانه می‌کند. من از <a class="reference external" href="http://www.djcbsoftware.nl/code/mu/mu4e.html">mu4e</a> استفاده کردم و مشکلی پیش نیامد.</p>
<p>اگر هم مثل من زبان C در دوران دانشگاه غول بی شاخ و دم ترسناکی بود که با اشاره‌گر‌هایش شما را به ته جهنم راهنمایی می‌کرد‌، باید بگویم که <a class="reference external" href="http://it-ebooks.info/book/704/">Head first C</a> همان اکسیری است که به آن نیاز داشتید. کتاب فوق‌العاده آسان و روان کل قضیه را بهتان شرح می‌دهد.</p>
<p>باز هم بگویید شاهین بد است. <a class="reference external" href="http://eudyptula-challenge.org/">little penguin</a> را معرفی کردم بهتان کمک کند تا ببینید خدایگان‌تان چطور برنامه می‌نویسند. <a class="reference external" href="http://it-ebooks.info/book/704/">Head first C</a> را معرفی کردم که یک بار دیگر مثل قدیم‌های من فکر نکنید که در جهنم C گیر کرده‌اید. و <a class="reference external" href="http://it-ebooks.info">it-ebooks</a> را معرفی کردم تا ببیند همهٔ کتاب‌های برنامه‌نویسی دنیا را عین‌الله جعفر نژاد قومی نمی‌نویسد ;-)</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/the-eudyptula-challenge/#disqus_thread" data-disqus-identifier="cache/posts/the-eudyptula-challenge.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/stop-bashing-bash-and-gnu/" class="u-url">از شرمنده کردن Bash و Gnu دست بردارید</a></h1>
            شاهین
      <a href="posts/stop-bashing-bash-and-gnu/" rel="bookmark"><time class="published dt-published" datetime="2014-09-29T07:28:51+03:30" title="2014-09-29 07:28">2014-09-29 07:28</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>چند روز اخیر اتفاق چالب توجهی در خصوص امنیت دنیای محبوب ما‌، گنو/لینوکس رخ داد که حواشی تکراری همیشگی را در پی داشت. بخش بسیار جالب قضیه برای من این بود که کشف <a class="reference external" href="https://access.redhat.com/announcements/1210053">shellshock</a> برای خیلی‌ها مثل این بود که انگار تا کنون هیچ باگ امنیتی‌ای در هیچ لایه‌ای از ابزار‌های مورد استفادهٔ عموم رخ نداده بود! نمونه‌های خارجی عکس‌العمل‌ها را که خیلی راحت می‌توانید پیدا کنید و چیزی که در ادامه خواهد آمد‌، در حقیقت جوابیه‌ای برای آن‌هاست‌، ولی در ایران خودمان مثلا <a class="reference external" href="http://www.zoomit.ir/it-news/security/14238-bash-shellshock-network-worm-could-cause-internet-meltdown">همچین مقاله‌ای</a> منتشر می‌شود‌، و از خود مقاله جالب‌تر‌، <a class="reference external" href="http://www.zoomit.ir/it-news/security/14238-bash-shellshock-network-worm-could-cause-internet-meltdown#comments">کامنت‌هایی</a> است که از ملت همیشه خود متخصص پندار می‌گیرد!</p>
<a class="reference external image-reference" href="https://en.wikipedia.org/wiki/Richard_Stallman"><img alt="Richard Stallman" src="https://upload.wikimedia.org/wikipedia/commons/5/54/NicoBZH_-_Richard_Stallman_%28by-sa%29_%2810%29.jpg"></a>
<p>به هر حال‌، متن زیر ترجمه‌ای از <a class="reference external" href="http://weev.livejournal.com/409835.html">اینجاست</a>. می‌دانم که ترجمه‌اش کاستی‌های زیادی دارد و می‌توانست خیلی بهتر باشد. ولی همانقدر که دلم می‌خواهد حق مطلب را عدا می‌کند.</p>
<blockquote>
<p>این دفاعیه‌ای برای خدمت‌گذاری پرکار و اختصاصی برای عموم است…. یک مرد که هزاران هزار میلیون‌، اگر نه تریلیون دلار ارزش به اقتصاد جهانی افزوده است. این مرد به شکلی خستگی ناپذیر برای سود بردن همهٔ اطرافیانش تلاش کرده. غیر ممکن است که شرکت تجاری عمومی‌ای را نام ببرید که به شکلی از تلاش‌های او سهم نبرده باشد‌، و بسیاری از آن‌ها هم هزاران میلیون از او سود کرده‌آند. در جواب به هزاران میلیون ثروت بیشماری که مردم از تلاش او به دست آوردند‌، او با فقر و استهزا پاداش گرفته است. حالا که دنیا همه چیزی که می‌توانسته را از او گرفته‌، در حال پیشرفت به مرحلهٔ بعدی یعنی بدنام کردن او به بی‌کفایتی است.</p>
<p>در مورد ریچارد استالمن صحبت می‌کنم‌، پیشرو انقلاب نرم‌افزار آزاد و خالق <a class="reference external" href="https://en.wikipedia.org/wiki/GNU_Project">GNU</a> (که گنو/لینوکس‌، بیشترین سیستم‌عامل توزیع شده در سطح جهان است و GNU <a class="reference external" href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> ، ابزاری که این اواخر دچار <a class="reference external" href="https://access.redhat.com/announcements/1210053">shellshock</a> های زیادی شده). او برای من یک قهرمان است و هرکسی که صادقانه تاریخ دنیای کامپیوتر را ورق می‌زند به این نتیجه خواهد رسید که تعداد کمی هستند که تلاش‌های‌شان ممکن است با اهمیت او قابل مقایسه باشد. من <a class="reference external" href="https://en.wikipedia.org/wiki/Ken_Thompson">Ken</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Dennis_Ritchie">Ritchie</a> و <a class="reference external" href="https://en.wikipedia.org/wiki/Alan_Turing">Turing</a> را در کنار او قرار می‌دهم. این شرم‌آور است که نیاز به این است که کسی مقاله‌ای بنویسد تا مردم از شرمنده کردن این مرد که به رایگان برای این که بعضی از بهترین نرم‌افزار‌هایی که تا به حال نوشته را در اختیار‌مان قرار دهد دست بردارند‌، ولی می‌بینم که تعدادی از کسانی که من معمولا بهشان احترام می‌گذارم در تلاش برای بدنام کردن این مرد هستند. گذشته از این‌، <a class="reference external" href="http://www.theguardian.com/technology/2014/sep/26/bash-bug-shellshock-richard-stallman">خبرگزاری‌های بی‌مسئولیتی چون گاردین این شانس را به خودشان می‌دهند</a> تا در مورد این مرد مزخرف بگویند و چرندیاتی بر ضد نرم‌افزار‌های آزاد به هم ببافند. در سال‌های گذشته تنفر از استالمن به یک مد در سیلیکون ولی تبدیل شده‌، و هر بحثی که در <a class="reference external" href="https://news.ycombinator.com/">هکر نیوز</a> به استالمن مربوط می‌شود‌، شامل توهین‌هایی کودکانه به اوست.</p>
<p>من برای سال‌ها از Bash به عنوان ابزار اصلی‌ام استفاده کرده‌ام. <a class="reference external" href="https://en.wikipedia.org/wiki/One-liner_program">one-liner</a> هایی نوشته‌ام که میلیون‌ها نفر را با پیام‌های شورشی (اجتماعی) اسپم کنم و <a class="reference external" href="http://brutal-honesty.livejournal.com/3168992.html">بازار تجارت روزانهٔ شرکت‌های تجاری عمومی را تحت تاثیر قرار دهم</a>. همچون  بسیاری دیگر از ابزار‌های گنویی که به رایگان توسط بنیاد نرم‌افزار‌های آزاد به ما ارزانی شده‌، من به طور مداوم برای تاثیرات شگفت‌انگیزشان از آن‌ها استفاده می‌کنم. این معمولا اولین ابزاریست که وقتی با مشکلی روبرو می‌شوم‌، از آن استفاده می‌کنم. بش واقعا همینقدر کاربردی است.</p>
<p>باگ <a class="reference external" href="https://access.redhat.com/announcements/1210053">Shellshock</a> یک شکست بحرانی در <a class="reference external" href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> نیست. بلکه شکستی بزرگ برای هزاران نفر از مردمی است که ابزاری با این همه کاربرد را می‌شناسند و تصمیم می‌گیرند که آن را فراتر از حدش گسترش دهند. ابزاری آن‌چنان انعطاف‌پذیر که حتی با رعایت نکردن نکات استفاده درستش‌، کسی را نا امید نمی‌کند. همه در دههٔ نود می‌دانستند وقتی شما یک دستور یونیکس را با ورودی غیر قابل اطمینان وارد می‌کنید‌، <a class="reference external" href="http://docstrange.livejournal.com/95142.html">اول متغیر‌های محیطی را پاک کرده‌اید</a>. هر کسی که ورودی غیرقابل اطمینان در اسکریپت شلش دارد‌، نمی‌داند که چه کار دارد می‌کند. حقیقت این است که مجبور کردن <a class="reference external" href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> به اجرای کد غیرقابل اطمینان‌، آن‌چنان هم دور از انتظار نیست. چیزی که انتظارش را نداشتم آن همه توسعه‌دهنده‌ایست که فکر می‌کردند که این قضیه جور دیگری خواهد بود.</p>
<p>داستان واقعی در اینجا‌، فراتر از یک باگ نرم‌افزاری  که همهٔ‌نرم‌افزار‌ها دارند است، و آن مسئولیتی غیرقابل انجام برای شانه‌های یک مرد است. دنیا از ریچارد استالمن بدون تشکر گرفت و گرفت. همه متخصصین مالی و اشخاص با نفوذ حوزه فناوری‌، که هزاران هزار میلیون دلار از کار‌های او به جیب زده‌اند‌، هرگز یک چک هم برای کمک به توسعه نرم‌افزارش برای او ننوشته‌اند. بعد از دهه‌ها خدمات بدون تشکر‌، دسته‌ای از اوباش همچون شغال به او حمله می‌کنند و او را به بی‌کفایتی برای تعدادی باگ متهم می‌کنند. ریچارد استالمن بیش از هر توسعه دهنده‌ای که به خاطر کارش پول می‌گیرد‌، کار مفید انجام داده. آن‌ها همچنین او را به خاطر روش‌های متفاوتش‌، پیری احمق خطاب می‌کنند. او همیشه متفاوت بوده است. من با او صحبت کرده‌ام و تضمین می‌دهم که می‌تواند هر کدام از منتقدین رقت انگیزش را سر جایشان بنشاند…. دنیا باید به پروژه گنو مقداری پول برای استخدام توسعه دهنده و متخصصین امنیتی می‌داد. جهنم‌، دنیا باید به استالمن جایی برای خواب می‌داد که صندلی‌ای در دانشگاه نباشد! هیچ عدالتی در این دنیا نیست.</p>
<p>این تکه‌ای از یک تئاتر است که بار‌ها و بارها اجرا شده. تکه‌های بزرگ و با اهمیت کد که به شدت مورد اطمینان قرار می‌گیرند‌، و هیچ کس نمی‌خواهد از آن‌ها پشتیبانی کند. <a class="reference external" href="https://en.wikipedia.org/wiki/OpenSSL">OpenSSL</a> کسی هست؟ مثل تکنولوژی‌های چاپ و پخش که از مردمی که آن‌ها را اختراع کردند دزدیده شد. اینترنت توسط چند بانکدار جهانی که از تلاش‌های کسانی قبل از خودشان سود می‌برند بار‌ها مورد سوء استفاده قرار گرفته. مردان و زنان شجاعی که برای ساخت اینترنت تلاش کردند هرگز یه سکه هم برای خودشان یا نسل‌های بعدشان به دست نیاورده‌اند. انگل‌ها این قدرت را دارند که به کسانی که در حال مکیدن خونشان هستند‌، توهین کنند و این مرا خشمگین می‌کند.</p>
<p>من برخلاف بعضی از مردم‌، از تلاش‌های استالمن میلیون‌ها دلار پول به دست نیاورده‌ام. این بدان معنا نیست که من کار‌هایی که او انجام داده است و چیزهایی که برای کامپیوتر و اینترنت انجام خواهد داد را از خاطر خواهم برد، حتی یک روز هم وجود نخواهد داشت که من از کار‌های او متشکر نباشم. شما مردم تکه‌های آشغالید. من حالم به هم می‌خورد‌، و شما می‌توانید <a class="reference external" href="http://5hah.in/categories/emacs.html">Emacs</a> ام را از <a class="reference external" href="https://en.wikipedia.org/wiki/NAND_gate">NAND</a> های سرد و مرده‌ام کاوش کنید.</p>
</blockquote>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/stop-bashing-bash-and-gnu/#disqus_thread" data-disqus-identifier="cache/posts/stop-bashing-bash-and-gnu.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/how-to-enable-php_intl-extension-and-use-it/" class="u-url">افزونه INTL PHP و کلاس NumberFormatter</a></h1>
            شاهین
      <a href="posts/how-to-enable-php_intl-extension-and-use-it/" rel="bookmark"><time class="published dt-published" datetime="2014-09-28T13:19:47+03:30" title="2014-09-28 13:19">2014-09-28 13:19</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>ممکن است مثل امروز من بخواهید یک مقدار عددی را به واحد پولی کشوری و به صورت درست در <a class="reference external" href="http://php.net">PHP</a> نمایش بدهید. در این صورت کلاس <a class="reference external" href="http://php.net/manual/en/class.numberformatter.php">NumberFormatter</a> می‌تواند کارتان را راه بیاندازد. برای مثال به تکه کد زیر نگاه کنید:</p>
<pre class="code php"><a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-1"></a><span class="cp">&lt;?php</span>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-2"></a><span class="nv">$number</span> <span class="o">=</span> <span class="mf">1234.56</span><span class="p">;</span>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-3"></a>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-4"></a><span class="nv">$iran</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NumberFormatter</span><span class="p">(</span><span class="s2">"fa-IR"</span><span class="p">,</span> <span class="nx">NumberFormatter</span><span class="o">::</span><span class="na">CURRENCY</span><span class="p">);</span>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-5"></a><span class="nv">$formatted3</span> <span class="o">=</span> <span class="nv">$iran</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="nv">$number</span><span class="p">);</span>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-6"></a>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-7"></a><span class="k">print</span> <span class="s2">"IRAN: "</span><span class="o">.</span><span class="nv">$formatted3</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>
<a name="rest_code_f6620334b8c9477fb1bd067176f8fe4e-8"></a><span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>خروجی این خطوط به این صورت خواهد بود:</p>
<pre class="code html"><a name="rest_code_a9172c060ccd424e9b6f67d822228c4d-1"></a>IRAN: ‎ریال۱٬۲۳۵
</pre>
<p>ولی ممکن است مثل من با این اخطار روبرو شوید:</p>
<pre class="code text"><a name="rest_code_bcf8a18e67344552a4be82e8956a6660-1"></a>Fatal error: Class 'NumberFormatter' not found
</pre>
<p>و این به این معناست که احتمالا افزونه intl در در نصب PHP‌تان فعال نیست. برای تست این که آیا نیاز به نصب دارید یا نه‌، دستور زیر را اجرا کنید:</p>
<pre class="code bash"><a name="rest_code_1ee22c571da24b68ba70f310ea74ce20-1"></a>php -m <span class="p">|</span> grep intl
</pre>
<p>اگر خروجی‌ای نداشتید یعنی این افزونه نصب نیست. بسته به توزیع مورد استفاده‌تان باید به دنبال روش نصبش باشید. مثلا در <a class="reference external" href="http://gentoo.org">Gentoo</a>:</p>
<pre class="code bash"><a name="rest_code_e2d24b7fd7eb4f1980fa18a8c79dc196-1"></a><span class="nv">use</span><span class="o">=</span><span class="s2">"intl"</span> emerge --oneshot -a php
</pre>
<p>یا در بعضی از توزیع‌های محبوب دیگر</p>
<pre class="code bash"><a name="rest_code_dee51bbf82ff44f192be660df1d011d4-1"></a>// Debian
<a name="rest_code_dee51bbf82ff44f192be660df1d011d4-2"></a>apt-get install php5-intl
<a name="rest_code_dee51bbf82ff44f192be660df1d011d4-3"></a>// Centos
<a name="rest_code_dee51bbf82ff44f192be660df1d011d4-4"></a>yum install php-intl
</pre>
<p>حالا که کار نصب تمام شد کافیست در فایل php.ini‌تان این خط را وارد کنید:</p>
<pre class="code text"><a name="rest_code_6765117887ba4c02ab45b1c65fa6cbba-1"></a>extension=php_intl.dll
</pre>
<p>و تمام‌، حالا این افزونه و کلاس <a class="reference external" href="http://php.net/manual/en/class.numberformatter.php">NumberFormatter</a> در دسترس‌تان است.</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/how-to-enable-php_intl-extension-and-use-it/#disqus_thread" data-disqus-identifier="cache/posts/how-to-enable-php_intl-extension-and-use-it.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/end-of-military-service/" class="u-url">پایان خدمت سربازی</a></h1>
            شاهین
      <a href="posts/end-of-military-service/" rel="bookmark"><time class="published dt-published" datetime="2014-09-26T11:10:27+03:30" title="2014-09-26 11:10">2014-09-26 11:10</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<img alt="My military boots." src="https://dl.dropboxusercontent.com/u/25017694/Blog-photos/Military_boots.png"><p>یکم مهر ماه ۱۳۹۳ آخرین روز خدمت سربازی‌ام بود. <a class="reference external" href="http://5hah.in/posts/shahin-in-military-service.html">قبلا</a> در مورد تمام خوش‌گذرانی‌هایی که در این دوران داشته‌ام نوشته‌ام‌، و خوب نالیدن بیشتر‌، تنها اعصاب خودم را خورد می‌کند. هر چه بود گذشت‌، تمام شد، دست خودم هم نبود انتخابش‌! باید می‌بود‌، باید اتفاق می‌افتاد! همین…</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/end-of-military-service/#disqus_thread" data-disqus-identifier="cache/posts/end-of-military-service.html">Comments</a>


    </div>

    </article><article class="h-entry post-text"><div class="text-center">

        <h1 class="p-name entry-title"><a href="posts/harvard-and-mit-students-launch-nsa-proof-email-service/" class="u-url">رونمایی از سرویس ایمیل «ضد NSA» توسط دانش‌آموزان ام‌آی‌تی و هاروارد</a></h1>
            شاهین
      <a href="posts/harvard-and-mit-students-launch-nsa-proof-email-service/" rel="bookmark"><time class="published dt-published" datetime="2014-05-19T18:02:45+04:30" title="2014-05-19 18:02">2014-05-19 18:02</time></a>
    </div>
    <div class="e-content entry-content">
    <div>
<p>بحث ایمیل امن و کل امنیت اینترنت بعد از انتشار اخبار جاسوسی‌های آمریکا (که بماند چون تنها کشوریست که مدرک مستدل بر علیهش وجود دارد‌، اسمش این‌طور دارد توی چشم فرو می‌رود‌، وگرنه که جاسوس‌ها از رگ گردن هم به ما نزدیک‌ترند) برای فعالان حرفه‌ای وب‌، نکتهٔ قابل توجهی است. حالا تعدادی از دانش‌آموزان دو دانشگاه هاروارد و ام‌آی‌تی ایمیلی را معرفی کرده‌اند که ادعا می‌کنند ایمیلی امن در برابر جاسوسی‌های NSA است. سیستم در حالت آزمایشی (Beta) قرار دارد‌، و هنوز نتوانسته‌ام وضعیتش را چک کنم‌، این است که متن اصلی خبری که خوانده‌ام را این‌جا می‌گذارم تا حساب کار دستتان بیاید:</p>
<blockquote>
<p>این ایمیل جدید <a class="reference external" href="https://protonmail.ch/">Protonmail</a> نام دارد. پنج نفر سازندهٔ آن موقعی که برای سازمان تحقیقات هسته‌ای اروپا (CERN) در سوئیس کار می‌کردند‌، با هم ملاقات کردند. و علاقهٔ مشترکشان برای ساخت یک ایمیل امن‌تر از <a class="reference external" href="http://lavabit.com/">Lavabit</a> ایمیل مورد انتخاب ادوارد اسنودن آن‌ها را دور هم جمع کرد.</p>
<p>بعد از چند هفته انتشار خصوصی نسخهٔ آزمایشی‌، <a class="reference external" href="https://protonmail.ch/">Protonmail</a> امروز وارد فاز انتشار عمومی نسخهٔ آزمایشی‌اش شد.</p>
<p>در سایت اصلی <a class="reference external" href="https://protonmail.ch/">Protonmail</a> سازندگانش توضیح می‌دهند که چه چیز‌هایی امنیت سرویس‌شان را تأمین می‌کند.</p>
<p>اول این‌که آن‌ها در سوئیس مستقر شده‌اند «که برایشان چند تا از قوی‌ترین قوانین حمایت از حریم خصوصی در جهان را به ارمغان می‌آورد». همچنین سایت اعلام می‌کند که آن‌ها از سیستم رمزگذاری end-to-end استفاده می‌کنند که کاملا بر اساس وضعیت احراض هویت کاربر عمل می‌کند و این به آن معناست که ظاهرا داده‌ها برای خود تیم ProtonMail هم غیرقابل دسترس است.</p>
<p>اندی ین به <a class="reference external" href="http://bostinno.streetwise.co/2014/05/16/protonmail-encrypted-email-service/">Bostinno</a> می‌گوید که «حتی ما هم امکان دسترسی و خواندن ایمیل‌ها را نداریم. پس اگر ما نمی‌توانیم آن‌ها را بخوانیم‌، قادر هم نخواهیم بود که آن را به سازمان‌های امنیتی دولت‌ها ارائه کنیم».</p>
<p>جامعهٔ تکنولوژی مدتی است که روی ابزار‌های پیام رسان فوق‌العاده امن کار می‌کند‌. اوایل امسال <a class="reference external" href="http://betabeat.com/2014/01/meet-blackphone-a-highly-secure-device-perfect-for-paranoid-sext-fiends/">Blackphone</a> تلفنی هوشمند رمزنگاری شده از مادرید را داشتیم. همچنین <a class="reference external" href="http://betabeat.com/2014/01/never-get-caught-demanding-bridge-closures-again-with-new-confide-app/">Confide</a> اَب پیام‌رسانی که از رمزنگاری برای امن نگاه داشتن پیام‌هایتان تا جای ممکن استفاده می‌کرد.</p>
<p>این سرویس رایگان و ظاهرا دارای روش استفادهٔ راحتی است‌، پس اگر از این که گوگل <a class="reference external" href="http://betabeat.com/2013/08/if-youre-having-an-affair-probably-avoid-gmail/">اجازه</a> می‌دهد که تمام پیغام‌هایتان را دیگران بخوانند خسته شده‌اید‌، چرا امتحانش نمی‌کنید؟</p>
</blockquote>
<p>حقیقتش خیلی وقت است که سعی می‌کنم کمتر از سرویس‌های گوگل استفاده کنم‌. سرویس دهنده‌ای که دیگر شعار اولیه‌اش را کنار گذاشته و دارد به هیولای اینترنت دوران ما تبدیل می‌شود. یک شبه تصمیم می‌گیرد که Google Reader را از بین ببرد. اطلاعات جستجوی ما را تا جای امکان ذخیره و بررسی می‌کند و در روشن‌بینانه‌ترین حالت تنها برای تبلیغات هدفمند استفاده‌شان می‌کند. و یا همین‌طور که در این مقاله گفته شد‌، اجازهٔ خواندن ایمیل‌های ما را به افراد دیگر می‌دهد.</p>
<p>هرچند که سرویس‌های جایگزین گاها امکاناتی را که گوگل ارائه می‌دهند را ندارند‌، ولی گاها باید ایده‌آل گرایی را برای داشتن امنیت کنار گذاشت.</p>
<p>این یکی را هم اضافه کنم که‌، صرف امن بودن این سرویس ایمیل‌، و باور کردن حرف‌های سازنده‌، برای خیلی‌ها مثل من ممکن است راضی کننده نباشد. روش‌های مکمل دیگری نیز وجود دارند که می‌توانند در این راه کمک کننده باشند. در آینده سعی می‌کنم بیشتر در مورد روش‌های امن کردن ارتباطات ایمیلی توضیح دهم.</p>
</div>
    </div>

    <div class="text-center">
                    <a class="btn btn-success" href="posts/harvard-and-mit-students-launch-nsa-proof-email-service/#disqus_thread" data-disqus-identifier="cache/posts/harvard-and-mit-students-launch-nsa-proof-email-service.html">Comments</a>


    </div>

    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-24.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="shahinism";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
    </div>
    <!--End of body content-->
  </div>

  <footer id="footer" class="site-footer">
    Contents © 2016         <a href="mailto:me@5hah.in">شاهین</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
    
  </footer><script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
  </script><!-- end fancy dates -->
</body>
</html>
