<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>شاهینیسم (dhcpcd)</title><link>http://shahinism.github.io</link><description>بعضی وقت‌ها باید قبل از این که بتوانید راه بروید‌، بدوید‌!</description><lastBuildDate>Fri, 27 Sep 2013 19:23:00 GMT</lastBuildDate><generator>nikola</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>dnscrypt روی اسلکور (‌و باقی لینوکس‌ها‌)</title><link>http://shahinism.github.io/posts/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhsh.html</link><description>&lt;p&gt;&lt;/p&gt;&lt;p&gt;حتما دیگه تا حالا خبر‌دار شدین که &lt;strong&gt;OpenDNS&lt;/strong&gt; ابزاری آماده کرده (‌البته قبلا برای مک آماده کرده بود‌) که ارتباط بین سیستم شما و DNS سرور‌های خودش رو به همون روشی که SSL ارتباطاتتون رو کد می‌کنه کد کنه‌. اول یه توضیح در مورد این که اصلا به چه درد می‌خوره می‌دم و بعد به چگونگی نصبش می‌پردازم‌.
&lt;/p&gt;&lt;h4&gt;DNS و نقش فایل resolv.conf:&lt;/h4&gt;
&lt;p&gt;خوب عملا کامپیوتر‌های روی یه شبکه (‌سرور‌ها و سرویس گیرنده‌ها‌) با آدرس آی پی شناخته می‌شن‌. خوب حالا برای من کاربر که قصد داره روی اینترنت به یه سایت دسترسی داشته باشه‌، سخته که یه عدد نافهوم مثل 188.35.73.20 رو حفظ کنم‌. تازه این فقط برای دسترسی به یه سایته‌. یا فرض کنین صاحب سایت به هر دلیلی قصد تعویض سرورش رو داره‌، در این صورت باید تمام کسایی که با آی پی قبلی به سایت دسترسی داشتن‌، از آی پی سرور جدید استفاده کنن‌. حالا کار DNS Server‌ها اینه که می‌آن‌، هر آدرس معنادار (‌که طبیعتا استاندارد خودش رو داره‌) رو به یه آدرس آی پی معادلش ربط می‌دن‌. اینطوریه که وقتی شما می‌نوسین &lt;strong&gt;http://shahinism.com&lt;/strong&gt; مرورگرتون آی پی و آدرس مسیری که وبلاگ من توش قرار داره رو پیدا می‌کنه و بهتون نشون می‌ده‌. به همین سادگی ;-)&lt;/p&gt;
&lt;p&gt;حالا بحث سر اینه که DNS Server‌های متفاوتی توی اینترنت هستن‌. هر کدومشون با توجه به سلایق خاصی شخصی سازی شدن‌. اگه شما تا به حال نمی‌دونستین که اصلا DNS Server چی هست‌، پس احتمالا دارین از مال ISP‌تون استفاده می‌کنین‌. حالا ممکن شما از رفتار ISP‌تون نسبت به DNS‌ها راضی نباشین‌. یا فکر کنین که امنیت لازم براتون از این DNS فراهم نمی‌شه (‌حتما فهمیدین که اگه یه DNS سرور بخواد‌، می‌تونه وقتی شما &lt;strong&gt;http://google.com&lt;/strong&gt; رو توی مرورگرتون می‌زنین‌، شما رو به آدرسی غیر از سرور‌های گوگل وارد کنه و این یعنی خطر‌!)&lt;/p&gt;
&lt;p&gt;این‌جاست که فایل resolv.conf توی لینوکس سر و کلش پیدا می‌شه‌. شما با استفاده از این فایل می‌تونین به لینوکس‌تون بفهمونید که از چه DNS Server‌ای استفاده کنه تا در خطر نباشین‌ (‌این کار رو اگه روترتون ازش پشتیبانی کنه می‌شه توی خود روتر هم انجام داد ;-))&lt;/p&gt;
&lt;h4&gt;مزیت استفاده از DNSCrypt&lt;/h4&gt;

&lt;p&gt;بزرگترین و بهترین مزیتش اینه که ما رو به صورت کاملا امن به سرور‌های OpenDNS وصل می‌کنه‌، و دیگه ارتباطمون با DNS Server غیر قابل شنود می‌شه‌. یعنی اگه شخص خرابکاری روی اینترنتمون باشه‌، باید اول با کدگذاری DNSCrypt بجنگه تا دستش به ما برسه‌!&lt;/p&gt;
&lt;h4&gt;نصب روی اسلکور (‌و اکثر توزیع‌ها‌)&lt;/h4&gt;

&lt;p&gt;خیلی راحت‌، اول با دستور زیر فایل‌ها رو می‌گیریم‌:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;git clone git://github.com/opendns/dnscrypt-proxy.git
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;بعد وارد پوشه می‌شیم و دستورات زیر رو به ترتیب می‌زنیم‌:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;./autogen

./configure

make -j4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;که اون ‏‎-j4 منظورم اینه که از همه زور CPUم استفاده کن (‌اگه شما CPUتون چهار هسته‌ای نیست می‌تونین تعداد هسته خودتون رو جای چهار بزارین یا کلا تگ j رو بیخیال شین) حالا برای این که وقتی دلمون خواست پاکش کنیم این کار رو می‌کنیم‌ (مخصوص اسلکور):&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;mkdir /tmp/dnscrypt

make install &lt;span class="nv"&gt;DESTDIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/tmp/dnscrypt

&lt;span class="nb"&gt;cd&lt;/span&gt; /tmp/dnscrypt

makepkg -l y -c n /tmp/dnscrypt.tgz

installpkg /tmp/dnscrypt.tgz
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;توی باقی توزیع‌ها تنها کافیه بزنین make install ولی خوب پاک کردنش پای خودتونه!&lt;/p&gt;
&lt;h5&gt;کار با DNSCrypt&lt;/h5&gt;

&lt;p&gt;برای کار باهاش اول اون رو با دستور زیر فعال می‌کنیم‌:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;/usr/local/sbin/dnscrypt-proxy -d
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;و اگه دلتون نمی‌خواد بعد از هر بار ری‌استارت دوباره این دستور رو بزنین‌، فقط کافیه توی فایل ‏‎/etc/rc.d/rc.local همین دستور بالا رو اضافه کنین‌.&lt;/p&gt;
&lt;p&gt;و در آخر با اضافه کردن خط زیر توی ‎/etc/resolv.conf به لینوکستون بگین که از 127.0.0.1 به عنوان DNS Server استفاده کنه‌:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;nameserver 127.0.0.1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;حواستون باشه که nameserver قبلی رو با اضافه کردن یه # کامنت کنین‌! حالا با مرورگرتون (‌و بدون استفاده از پروکسی‌) &lt;a title="Are you using OpenDNS?" href="http://www.opendns.com/welcome/" target="_blank"&gt;این صفحه&lt;/a&gt; رو ببینین‌. احتمالا بهتون تبریک می‌گه که از OpenDNS استفاده می‌کنین ;-)&lt;/p&gt;
&lt;h5&gt;حل یک مشکل:&lt;/h5&gt;

&lt;p&gt;احتمالا بعد از اولین ریبوت می‌فهمین که فایل resolv.conf‌تون دوباره عوض شده و آدرس قبلی توش نیست‌! این به دلیل استفاده از dhcpcd هست که تنظیمات این فایل رو بعد از هر بار شناسایی آی پی روتر دوباره‌نویسی می‌کنه‌. خوب حالا چاره چیه‌؟ هیچی دستور زیر رو می‌زنیم:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre&gt;chattr +i /etc/resolv.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;که یعنی دست خر کوتاه‌! &lt;del&gt;(‌یعنی هیچ‌کس غیر از صاحب فایل حق دست زدن بهش رو نداشته باشه‌)&lt;/del&gt;  در مورد این که این دستور دقیقا چی کار می‌کنه می‌تونین به&lt;a title="مجوزهای دسترسی فایل سیستم‌های ext در لینوکس" href="http://weblog.aqlinux.ir/?p=204" target="_blank"&gt; این مطلب&lt;/a&gt; از علی عزیز در آکلینوکس رجوع کنین ;-)&lt;del&gt;&lt;/del&gt;&lt;/p&gt;</description><category>dhcpcd</category><category>DNS</category><category>DNS Server</category><category>OpenDNS</category><category>resolv.conf</category><category>Slackware</category><category>اسلکور</category><category>اینترنت</category><category>سرور</category><category>نرم افزار</category><category>کدباز</category><guid>http://shahinism.github.io/posts/blog13901130dnscrypt-rwy-slkhwr-w-bqy-lynwkhsh.html</guid><pubDate>Sun, 19 Feb 2012 15:47:14 GMT</pubDate></item></channel></rss>